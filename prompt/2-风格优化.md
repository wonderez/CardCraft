### ç”¨æˆ·:
é¡¹ç›®èƒŒæ™¯ æˆ‘æ­£åœ¨å¼€å‘ä¸€ä¸ª Windows æ¡Œé¢åº”ç”¨ã€ŒCardCraftã€ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯ï¼š - ç”¨æˆ·è¾“å…¥ Markdown æ–‡æœ¬ - è‡ªåŠ¨æ¸²æŸ“æˆå°çº¢ä¹¦é£æ ¼çš„ç²¾ç¾å¡ç‰‡ - æ™ºèƒ½åˆ†é¡µï¼ˆ3:4 æ¯”ä¾‹ï¼Œ1080Ã—1440pxï¼‰ - æ‰¹é‡å¯¼å‡ºé«˜è´¨é‡å›¾ç‰‡ Â  # æŠ€æœ¯æ ˆ - æ¡†æ¶ï¼šPySide6 (Qt for Python) - æ¸²æŸ“ï¼šQWebEngineView (åŸºäº Chromium) - Markdownè§£æï¼špython-markdown + æ‰©å±• - æ ·å¼ï¼šHTML + CSS (å°çº¢ä¹¦é£æ ¼) - åˆ†é¡µï¼šJavaScript (åœ¨ WebEngine ä¸­æ‰§è¡Œ) Â  # æ ¸å¿ƒæ¶æ„è®¾è®¡ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Â Â Â Â Â Â Â Â Â Â ä¸»çª—å£ (MainWindow) Â Â Â Â Â Â Â Â Â Â â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ Â ç¼–è¾‘å™¨ç»„ä»¶ Â â”‚ Â Â é¢„è§ˆç»„ä»¶ Â Â Â â”‚ Â å·¥å…·æ  Â Â â”‚ â”‚ (QTextEdit) â”‚(QWebEngineView)â”‚ (QToolBar)â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Markdownè§£æ Â â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Â HTMLç”Ÿæˆ Â Â Â â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Â æ™ºèƒ½åˆ†é¡µ Â Â Â â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Â æ ·å¼æ¸²æŸ“ Â Â Â â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Â å›¾ç‰‡å¯¼å‡º Â Â Â â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Â  # é¡¹ç›®ç»“æ„
cardcraft/ â”œâ”€â”€ main.py Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â # å¯åŠ¨ç¨‹åºï¼Œåˆ›å»º Qt åº”ç”¨ â”œâ”€â”€ requirements.txt Â Â Â Â Â Â Â Â Â Â Â # ä¾èµ–åŒ…åˆ—è¡¨ï¼šPySide6ã€markdown ç­‰ â”‚ src/ â”œâ”€â”€ ui/ â”‚ Â Â â”œâ”€â”€ main_window.py Â Â Â Â Â Â Â Â # ä¸»çª—å£ï¼šå·¦å³åˆ†æ å¸ƒå±€ï¼Œå¯¼å‡ºæŒ‰é’®ï¼Œ300mså»¶è¿Ÿæ›´æ–° â”‚ Â Â â”œâ”€â”€ editor_widget.py Â Â Â Â Â Â # å·¦ä¾§ç¼–è¾‘å™¨ï¼šQTextEditï¼Œå«ç¤ºä¾‹æ–‡æœ¬ â”‚ Â Â â”œâ”€â”€ preview_widget.py Â Â Â Â Â # å³ä¾§é¢„è§ˆï¼šQWebEngineViewï¼Œé›†æˆåˆ†é¡µå’Œå¯¼å‡ºåŠŸèƒ½ â”‚ Â Â  â”œâ”€â”€ core/ â”‚ Â Â â”œâ”€â”€ markdown_processor.py Â # Markdown è½¬ HTMLï¼šä½¿ç”¨ python-markdown åº“ â”‚ Â Â â”œâ”€â”€ html_generator.py Â Â Â Â Â # ç”Ÿæˆå®Œæ•´ç½‘é¡µï¼šæ”¯æŒé¡µç ã€å¤šä¸»é¢˜CSSæ ·å¼ â”‚ Â Â  â”œâ”€â”€ utils/ â”‚ Â Â â”œâ”€â”€ paginator.py Â Â Â Â Â Â Â Â Â Â # âœ… æ™ºèƒ½åˆ†é¡µå™¨ï¼šHTMLå…ƒç´ è§£æã€é«˜åº¦ä¼°ç®—ã€åˆ†é¡µä¼˜åŒ– â”‚ Â Â â”œâ”€â”€ exporter.py Â Â Â Â Â Â Â Â Â Â Â # âœ… å›¾ç‰‡å¯¼å‡ºå™¨ï¼šæ‰¹é‡å¯¼å‡ºã€è¿›åº¦è¿½è¸ªã€æ°´å°æ·»åŠ  â”‚ Â Â â”œâ”€â”€ style_manager.py Â Â Â Â Â Â # âœ… æ ·å¼ç®¡ç†å™¨ï¼šå¤šä¸»é¢˜æ”¯æŒï¼ˆå°çº¢ä¹¦/Instagram/å¾®ä¿¡/çŸ¥ä¹/æ·±è‰²ï¼‰ â”‚ Â Â  â”œâ”€â”€ resources/ â”‚ Â Â â”œâ”€â”€ styles/ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â # ï¿½ï¿½ é¢„ç•™ï¼šæœªæ¥å¯å­˜æ”¾ç‹¬ç«‹CSSæ–‡ä»¶ â”‚ Â Â â””â”€â”€ templates/ Â Â Â Â Â Â Â Â Â Â Â Â # ï¿½ï¿½ é¢„ç•™ï¼šæœªæ¥å¯å­˜æ”¾HTMLæ¨¡æ¿æ–‡ä»¶# æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚ Â  ## 1. æ™ºèƒ½åˆ†é¡µç®—æ³• - æ¯é¡µå›ºå®šå°ºå¯¸ï¼š1080Ã—1440px (3:4æ¯”ä¾‹) - åˆ†é¡µåŸåˆ™ï¼š Â Â * æ®µè½å®Œæ•´æ€§ï¼šä¸åœ¨æ®µè½ä¸­é—´åˆ†é¡µ Â Â * æ ‡é¢˜å…³è”ï¼šæ ‡é¢˜ä¸å…¶åç»­å†…å®¹ä¿æŒåŒé¡µ Â Â * åˆ—è¡¨è¿ç»­ï¼šåˆ—è¡¨é¡¹å°½é‡ä¸åˆ†ç¦» Â Â * ä»£ç å®Œæ•´ï¼šä»£ç å—ä¸è·¨é¡µ Â Â * è§†è§‰å¹³è¡¡ï¼šé¿å…é¡µé¢è¿‡ç©ºæˆ–è¿‡æ»¡ Â  ## 2. æ ·å¼ç³»ç»Ÿ - é¢„è®¾ä¸»é¢˜ï¼šå°çº¢ä¹¦ã€Instagramã€å¾®ä¿¡ã€çŸ¥ä¹ç­‰ - æ ·å¼è¦ç´ ï¼š Â Â * å­—ä½“ï¼šä¸­æ–‡ç”¨è‹¹æ–¹/å¾®è½¯é›…é»‘ï¼Œè¥¿æ–‡ç”¨ Helvetica Â Â * é¢œè‰²ï¼šä¸»è‰² `#FF2442`ï¼Œæ–‡å­— `#333333` Â Â * é—´è·ï¼šæ®µè½é—´è· 20pxï¼Œè¡Œé«˜ 1.8 Â Â * ç‰¹æ•ˆï¼šå¡ç‰‡é˜´å½±ã€åœ†è§’ã€æ¸å˜èƒŒæ™¯ Â  ## 3. æ¸²æŸ“æµç¨‹ ```python # ä¼ªä»£ç ç¤ºä¾‹ markdown_text â†’ parse_markdown() â†’ generate_html() â†’ apply_styles() â†’ paginate() â†’ render_preview() â†’ export_images() 4. å¯¼å‡ºåŠŸèƒ½ Â  æ ¼å¼ï¼šPNG/JPEG è´¨é‡ï¼šæ”¯æŒ 1x/2x/3x åˆ†è¾¨ç‡ å‘½åï¼šè‡ªåŠ¨ç¼–å·ï¼Œå¦‚ card_01.png, card_02.png æ‰¹é‡ï¼šä¸€æ¬¡å¯¼å‡ºæ‰€æœ‰åˆ†é¡µ Â  ä»£ç è§„èŒƒ Â  ä½¿ç”¨ç±»å‹æ³¨è§£ (typing) éµå¾ª PEP 8 ä¸­æ–‡æ³¨é‡Šè¯´æ˜å…³é”®é€»è¾‘ é”™è¯¯å¤„ç†è¦å®Œå–„ Â  æ€§èƒ½è¦æ±‚ Â  å®æ—¶é¢„è§ˆå»¶è¿Ÿ < 300ms æ”¯æŒ 10000 å­—çš„æ–‡æ¡£ å¯¼å‡ºé€Ÿåº¦ï¼šæ¯å¼ å¡ç‰‡ < 1ç§’ Â  é—®é¢˜æè¿° ç›®å‰å±å¹•å¤ªå›ºå®šäº†ï¼Œæˆ‘å¸Œæœ›æœ‰ç›¸åŒæ¯”ä¾‹çš„ å°-ä¸­-å¤§ä¸‰ä¸ªå°ºå¯¸ï¼ˆå­—ä½“ä¸å˜ï¼Œæˆ‘æƒ³è¦çš„æ€è·¯æ˜¯ï¼Œå°±æ˜¯å¤§çš„é¡µé¢å¯ä»¥æ”¾æ›´å¤šçš„å†…å®¹ï¼Œå°çš„æ”¾çš„å°‘ï¼Œä¿¡æ¯é‡çš„åŒºåˆ«ï¼‰ï¼Œç„¶åå¤šå‡ ç§é…è‰²æ ·å¼é£æ ¼ æœŸæœ›è¾“å‡º ï¼šé¦–å…ˆåˆ†æå¤šæ­¥æ­¥éª¤ï¼Œå¹¶ä¸€æ­¥ä¸€æ­¥å®Œæˆï¼Œå…ˆå®Œæˆç¬¬ä¸€æ­¥ã€‚ä¿®æ”¹é—®é¢˜çš„ä»£ç ï¼›è‹¥ä¿®æ”¹å°åˆ™ç›´æ¥å‘Šè¯‰æˆ‘ä½ç½®ï¼Œæˆ‘ä¸ªäººè¿›è¡Œä¿®æ”¹ï¼›è‹¥å˜åŠ¨å¤§ï¼Œåˆ™ç»™æˆ‘è¿™ä¸ªæ–‡ä»¶çš„å®Œæ•´ä»£ç 
html_generator.py->text/plain-># ============================================
# src/core/html_generator.py
# ============================================
from pathlib import Path
from typing import Optional

class HTMLGenerator:
    def __init__(self, font_size: int = 18):
        self.resource_path = Path(__file__).parent.parent / "resources"
        self.base_font_size = font_size  # åŸºç¡€å­—ä½“å¤§å°ï¼Œé»˜è®¤18px
        
    def generate(self, content: str) -> str:
        """
        ç”Ÿæˆå®Œæ•´çš„ HTML é¡µé¢ï¼ˆæ— æ°´å°å’Œé¡µç ï¼‰
        
        Args:
            content: HTMLå†…å®¹
        """
        css = self.get_css()
        js = self.get_js()
        
        html = f"""
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°çº¢ä¹¦å¡ç‰‡</title>
    <style>{css}</style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="content" id="content">
                {content}
            </div>
        </div>
    </div>
    <script>{js}</script>
</body>
</html>
"""
        return html
        
    def set_font_size(self, size: int):
        """è®¾ç½®åŸºç¡€å­—ä½“å¤§å°"""
        self.base_font_size = size
        
    def get_css(self) -> str:
        """è·å–ä¼˜åŒ–åçš„CSSæ ·å¼ï¼ˆæ›´å¤§å­—ä½“ï¼Œæ— æ°´å°ï¼‰"""
        # åŠ¨æ€è®¡ç®—å­—ä½“å¤§å°
        base = self.base_font_size
        
        return f"""
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        
        /* å›ºå®šHTMLå’Œbodyå°ºå¯¸ï¼Œç¦ç”¨æ»šåŠ¨ */
        html, body {{
            width: 1080px;
            height: 1440px;
            overflow: hidden !important;
        }}
        
        body {{
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", 
                        "Helvetica Neue", "Hiragino Sans GB", "Microsoft YaHei UI",
                        "Microsoft YaHei", Arial, sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe0f0 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            font-size: {base}px;  /* åŸºç¡€å­—ä½“ä»16pxå¢åŠ åˆ°18px */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }}
        
        .container {{
            width: 1080px;
            height: 1440px;
            position: relative;
        }}
        
        .card {{
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(255, 36, 66, 0.08),
                        0 2px 10px rgba(0, 0, 0, 0.06);
            overflow: hidden;
            position: relative;
        }}
        
        .content {{
            padding: 50px 45px 50px 45px;  /* ç¨å¾®å¢åŠ å†…è¾¹è· */
            color: #2c3e50;
            line-height: 1.85;  /* ç¨å¾®å¢åŠ è¡Œé«˜ */
            height: 100%;
            overflow: hidden !important;
            position: relative;
        }}
        
        /* æ ‡é¢˜æ ·å¼ - ç›¸åº”æ”¾å¤§ */
        h1 {{
            color: #FF2442;
            font-size: {base + 16}px;  /* 34px */
            margin-bottom: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
            border-bottom: 3px solid #FFE4E4;
            padding-bottom: 16px;
        }}
        
        h2 {{
            color: #FF2442;
            font-size: {base + 10}px;  /* 28px */
            margin-top: 38px;
            margin-bottom: 22px;
            font-weight: 600;
            position: relative;
            padding-left: 20px;
        }}
        
        h2::before {{
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 24px;
            background: linear-gradient(180deg, #FF2442, #FF6B6B);
            border-radius: 3px;
        }}
        
        h3 {{
            color: #34495e;
            font-size: {base + 5}px;  /* 23px */
            margin-top: 30px;
            margin-bottom: 18px;
            font-weight: 600;
        }}
        
        h4 {{
            color: #34495e;
            font-size: {base + 2}px;  /* 20px */
            margin-top: 25px;
            margin-bottom: 15px;
            font-weight: 600;
        }}
        
        /* æ®µè½æ ·å¼ */
        p {{
            margin-bottom: 22px;
            font-size: {base}px;  /* 18px */
            color: #4a5568;
            text-align: justify;
            line-height: 1.85;
        }}
        
        /* å¼ºè°ƒæ ·å¼ */
        strong {{
            color: #FF2442;
            font-weight: 600;
            background: linear-gradient(180deg, transparent 70%, #FFE4E4 70%);
            padding: 0 4px;
        }}
        
        em {{
            font-style: italic;
            color: #718096;
        }}
        
        /* åˆ—è¡¨æ ·å¼ */
        ul, ol {{
            margin: 24px 0;
            padding-left: 38px;
        }}
        
        li {{
            margin-bottom: 16px;
            font-size: {base}px;  /* 18px */
            color: #4a5568;
            line-height: 1.85;
        }}
        
        ul li::marker {{
            color: #FF2442;
            font-size: {base + 2}px;  /* 20px */
        }}
        
        ol li::marker {{
            color: #FF2442;
            font-weight: 600;
        }}
        
        /* å¼•ç”¨æ ·å¼ */
        blockquote {{
            border-left: 4px solid #FF2442;
            margin: 28px 0;
            padding: 20px 28px;
            background: linear-gradient(90deg, #FFF8F8 0%, #FFFFFF 100%);
            border-radius: 10px;
            position: relative;
        }}
        
        blockquote::before {{
            content: '"';
            position: absolute;
            top: -10px;
            left: 24px;
            font-size: 48px;
            color: #FFE4E4;
            font-family: Georgia, serif;
        }}
        
        blockquote p {{
            color: #6b7280;
            font-style: italic;
            margin-bottom: 0;
            font-size: {base - 1}px;  /* 17px */
        }}
        
        /* è¡Œå†…ä»£ç  */
        code {{
            background: #FFF5F5;
            padding: 4px 10px;
            border-radius: 6px;
            font-family: "JetBrains Mono", "Cascadia Code", "Consolas", "Monaco", monospace;
            font-size: {base - 2}px;  /* 16px */
            color: #e53e3e;
            font-weight: 500;
        }}
        
        /* ä»£ç å— */
        pre {{
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 26px;
            border-radius: 12px;
            overflow-x: auto;
            margin: 28px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            position: relative;
            max-width: 100%;
        }}
        
        pre::before {{
            content: "CODE";
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 11px;
            color: #6b7280;
            font-weight: 600;
            letter-spacing: 1px;
            opacity: 0.5;
        }}
        
        pre code {{
            background: none;
            color: #d4d4d4;
            padding: 0;
            font-size: {base - 3}px;  /* 15px */
            line-height: 1.7;
        }}
        
        /* è¡¨æ ¼æ ·å¼ */
        table {{
            width: 100%;
            border-collapse: collapse;
            margin: 28px 0;
            font-size: {base - 1}px;  /* 17px */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
            border-radius: 10px;
            overflow: hidden;
        }}
        
        th {{
            background: linear-gradient(135deg, #FF2442, #FF6B6B);
            color: white;
            padding: 15px 20px;
            text-align: left;
            font-weight: 600;
            font-size: {base - 1}px;  /* 17px */
        }}
        
        td {{
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
            color: #4a5568;
        }}
        
        tr:nth-child(even) {{
            background: #FAFAFA;
        }}
        
        tr:hover {{
            background: #FFF5F5;
        }}
        
        tr:last-child td {{
            border-bottom: none;
        }}
        
        /* åˆ†éš”çº¿ */
        hr {{
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, #FFE4E4 20%, #FFE4E4 80%, transparent);
            margin: 38px 0;
        }}
        
        /* é“¾æ¥æ ·å¼ */
        a {{
            color: #FF2442;
            text-decoration: none;
            border-bottom: 1px solid #FFD0D7;
            transition: all 0.3s ease;
            padding-bottom: 1px;
        }}
        
        a:hover {{
            color: #FF6B6B;
            border-bottom-color: #FF6B6B;
            background: #FFF5F5;
            padding: 0 4px;
            margin: 0 -4px;
            border-radius: 3px;
        }}
        
        /* éšè—æ‰€æœ‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {{
            display: none !important;
        }}
        
        * {{
            scrollbar-width: none !important;
            -ms-overflow-style: none !important;
        }}
        
        /* æ‰“å°æ ·å¼ */
        @media print {{
            body {{
                background: white;
                padding: 0;
            }}
            
            .container {{
                max-width: 100%;
            }}
            
            .card {{
                box-shadow: none;
                border-radius: 0;
                page-break-inside: avoid;
            }}
        }}
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {{
            from {{
                opacity: 0;
                transform: translateY(10px);
            }}
            to {{
                opacity: 1;
                transform: translateY(0);
            }}
        }}
        
        .content > * {{
            animation: fadeIn 0.5s ease-out;
        }}
        """
    
    def get_js(self) -> str:
        """è·å–JavaScriptä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰"""
        return """
        // é¡µé¢åŠ è½½å®Œæˆåçš„å¤„ç†
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ æ·¡å…¥åŠ¨ç”»
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '0';
                content.style.transition = 'opacity 0.5s ease-in';
                setTimeout(() => {
                    content.style.opacity = '1';
                }, 100);
            }
            
            // å›¾ç‰‡è‡ªé€‚åº”
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                img.loading = 'lazy';
                img.style.maxWidth = '100%';
                img.style.height = 'auto';
                img.style.borderRadius = '8px';
                img.style.margin = '16px 0';
            });
            
            // ç¡®ä¿å†…å®¹ä¸è¶…å‡º
            function ensureContentFit() {
                const card = document.querySelector('.card');
                const content = document.querySelector('.content');
                if (card && content) {
                    content.style.maxHeight = '100%';
                    content.style.overflow = 'hidden';
                }
            }
            
            ensureContentFit();
            window.addEventListener('resize', ensureContentFit);
        });
        
        // ç¦ç”¨æ‰€æœ‰æ»šåŠ¨
        window.addEventListener('scroll', function(e) {
            e.preventDefault();
            window.scrollTo(0, 0);
        }, { passive: false });
        
        window.addEventListener('wheel', function(e) {
            e.preventDefault();
        }, { passive: false });
        
        window.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
        """ markdown_processor.py->text/plain-># ============================================
# src/core/markdown_processor.py
# ============================================
import markdown
from markdown.extensions import fenced_code, tables

class MarkdownProcessor:
    def __init__(self):
        # åªä½¿ç”¨å¿…è¦ä¸”ç¨³å®šçš„æ‰©å±•
        self.extensions = [
            'markdown.extensions.fenced_code',  # ä»£ç å—
            'markdown.extensions.tables',       # è¡¨æ ¼
            'markdown.extensions.nl2br',        # æ¢è¡Œè½¬<br>
            'markdown.extensions.attr_list',    # å±æ€§åˆ—è¡¨
            'markdown.extensions.def_list',     # å®šä¹‰åˆ—è¡¨
            'markdown.extensions.footnotes',    # è„šæ³¨
            'markdown.extensions.toc',          # ç›®å½•
            'markdown.extensions.sane_lists',   # æ”¹è¿›çš„åˆ—è¡¨
            'markdown.extensions.smarty',       # æ™ºèƒ½æ ‡ç‚¹
        ]
        
        # é…ç½®æ‰©å±•ï¼ˆç§»é™¤ä¸æ”¯æŒçš„ css_class å‚æ•°ï¼‰
        self.extension_configs = {}
        
    def parse(self, text: str) -> str:
        """è§£æ Markdown æ–‡æœ¬ä¸º HTML"""
        try:
            # åˆ›å»ºæ–°çš„ Markdown å®ä¾‹ï¼ˆé¿å…çŠ¶æ€æ±¡æŸ“ï¼‰
            md = markdown.Markdown(
                extensions=self.extensions,
                extension_configs=self.extension_configs
            )
            
            # è½¬æ¢ Markdown ä¸º HTML
            html = md.convert(text)
            
            # åå¤„ç†ï¼šæ·»åŠ å°çº¢ä¹¦ç‰¹è‰² emoji æ”¯æŒ
            html = self._process_emojis(html)
            
            return html
            
        except Exception as e:
            print(f"Markdown è§£æé”™è¯¯: {e}")
            return f"<p style='color: red;'>è§£æé”™è¯¯: {str(e)}</p>"
    
    def _process_emojis(self, html: str) -> str:
        """å¤„ç† emoji è¡¨æƒ…"""
        # ä¿æŒ emoji åŸæ ·æ˜¾ç¤º
        return html style_manager.py->text/plain-> editor_widget.py->text/plain-># ============================================
# src/ui/editor_widget.py
# ============================================
from PySide6.QtWidgets import QTextEdit, QVBoxLayout, QWidget, QLabel, QFrame
from PySide6.QtGui import QFont, QTextOption, QPalette, QColor
from PySide6.QtCore import Signal, Qt

class EditorWidget(QWidget):
    textChanged = Signal()
    scrollChanged = Signal(float)  # å‘é€æ»šåŠ¨ç™¾åˆ†æ¯”
    
    def __init__(self):
        super().__init__()
        self.init_ui()
        
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        layout.setContentsMargins(0, 0, 0, 0)
        layout.setSpacing(0)
        
        # åˆ›å»ºå®¹å™¨æ¡†æ¶
        container = QFrame()
        container.setStyleSheet("""
            QFrame {
                background: rgba(25, 25, 40, 0.95);
                border: 1px solid rgba(0, 224, 255, 0.2);
                border-radius: 16px;
            }
        """)
        container_layout = QVBoxLayout(container)
        container_layout.setContentsMargins(0, 0, 0, 0)
        container_layout.setSpacing(0)
        
        # æ ‡é¢˜æ 
        title_bar = QFrame()
        title_bar.setFixedHeight(50)
        title_bar.setStyleSheet("""
            QFrame {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.1),
                    stop: 0.5 rgba(0, 150, 255, 0.15),
                    stop: 1 rgba(0, 224, 255, 0.1)
                );
                border-top-left-radius: 16px;
                border-top-right-radius: 16px;
                border-bottom: 1px solid rgba(0, 224, 255, 0.2);
                padding: 12px 20px;
            }
        """)
        title_layout = QVBoxLayout(title_bar)
        
        title = QLabel("âœï¸ Markdown ç¼–è¾‘å™¨")
        title.setStyleSheet("""
            QLabel {
                color: #00e0ff;
                font-size: 16px;
                font-weight: 600;
                letter-spacing: 0.5px;
            }
        """)
        title_layout.addWidget(title)
        
        # ç¼–è¾‘å™¨
        self.editor = QTextEdit()
        self.editor.setFont(QFont("Cascadia Code, Consolas, Monaco", 12))
        self.editor.setLineWrapMode(QTextEdit.WidgetWidth)
        self.editor.setWordWrapMode(QTextOption.WordWrap)
        
        # è®¾ç½®ç¼–è¾‘å™¨æ ·å¼
        self.editor.setStyleSheet("""
            QTextEdit {
                border: none;
                padding: 25px;
                background-color: rgba(15, 15, 25, 0.6);
                color: #e0e6ed;
                selection-background-color: rgba(0, 224, 255, 0.3);
                selection-color: #ffffff;
                border-bottom-left-radius: 16px;
                border-bottom-right-radius: 16px;
                font-size: 14px;
                line-height: 1.6;
            }
            QScrollBar:vertical {
                background: rgba(20, 20, 35, 0.5);
                width: 12px;
                border-radius: 6px;
                margin: 5px;
            }
            QScrollBar::handle:vertical {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.4),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
                border-radius: 6px;
                min-height: 30px;
            }
            QScrollBar::handle:vertical:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.6),
                    stop: 1 rgba(0, 150, 255, 0.5)
                );
            }
            QScrollBar::add-line:vertical,
            QScrollBar::sub-line:vertical {
                border: none;
                background: none;
                height: 0;
            }
            QScrollBar:horizontal {
                background: rgba(20, 20, 35, 0.5);
                height: 12px;
                border-radius: 6px;
                margin: 5px;
            }
            QScrollBar::handle:horizontal {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.4),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
                border-radius: 6px;
                min-width: 30px;
            }
            QScrollBar::handle:horizontal:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.6),
                    stop: 1 rgba(0, 150, 255, 0.5)
                );
            }
            QScrollBar::add-line:horizontal,
            QScrollBar::sub-line:horizontal {
                border: none;
                background: none;
                width: 0;
            }
        """)
        
        # è®¾ç½®é»˜è®¤æ–‡æœ¬
        self.editor.setPlainText("""# ğŸŒ¸ å°çº¢ä¹¦ç¬”è®°æ ‡é¢˜

## ä»Šæ—¥åˆ†äº«

å¤§å®¶å¥½å‘€ï½ä»Šå¤©ç»™å¤§å®¶åˆ†äº«ä¸€ä¸ªè¶…å®ç”¨çš„ **Markdown ç¼–è¾‘å™¨**ï¼

### âœ¨ ä¸»è¦åŠŸèƒ½

1. **å®æ—¶é¢„è§ˆ** - å·¦è¾¹å†™ï¼Œå³è¾¹çœ‹
2. **æ™ºèƒ½åˆ†é¡µ** - è‡ªåŠ¨é€‚é…å°çº¢ä¹¦å¡ç‰‡å°ºå¯¸
3. **ä¸€é”®å¯¼å‡º** - æ‰¹é‡ç”Ÿæˆç²¾ç¾å›¾ç‰‡

### ğŸ“ ä½¿ç”¨æ–¹æ³•

- åœ¨å·¦ä¾§è¾“å…¥ Markdown æ–‡æœ¬
- å³ä¾§å®æ—¶æ˜¾ç¤ºé¢„è§ˆæ•ˆæœ
- ç‚¹å‡»å¯¼å‡ºæŒ‰é’®ä¿å­˜å›¾ç‰‡

> ğŸ’¡ å°è´´å£«ï¼šæ”¯æŒæ‰€æœ‰å¸¸ç”¨çš„ Markdown è¯­æ³•å“¦ï½

### ä»£ç ç¤ºä¾‹

```python
def hello():
    print("Hello, å°çº¢ä¹¦!")
    return "â¤ï¸"
```

### è¡¨æ ¼ç¤ºä¾‹

| åŠŸèƒ½ | æè¿° | çŠ¶æ€ |
|------|------|------|
| ç¼–è¾‘ | Markdownç¼–è¾‘å™¨ | âœ… |
| é¢„è§ˆ | å®æ—¶æ¸²æŸ“ | âœ… |
| å¯¼å‡º | å›¾ç‰‡ç”Ÿæˆ | âœ… |

---

å–œæ¬¢çš„è¯è®°å¾— **ç‚¹èµæ”¶è—** å“¦ï½ â¤ï¸

å…³æ³¨æˆ‘ï¼Œè·å–æ›´å¤šå®ç”¨å·¥å…·ï¼""")
        
        # è¿æ¥ä¿¡å·
        self.editor.textChanged.connect(self.textChanged.emit)
        self.editor.verticalScrollBar().valueChanged.connect(self.on_scroll)
        
        # ç»„è£…å¸ƒå±€
        container_layout.addWidget(title_bar)
        container_layout.addWidget(self.editor)
        
        layout.addWidget(container)
        
    def get_text(self):
        """è·å–ç¼–è¾‘å™¨æ–‡æœ¬"""
        return self.editor.toPlainText()
    
    def on_scroll(self):
        """å¤„ç†æ»šåŠ¨äº‹ä»¶"""
        scrollbar = self.editor.verticalScrollBar()
        if scrollbar.maximum() > 0:
            percentage = scrollbar.value() / scrollbar.maximum()
            self.scrollChanged.emit(percentage) main_window.py->text/plain-># ============================================
# src/ui/main_window.py
# ============================================
from PySide6.QtWidgets import (QMainWindow, QHBoxLayout, QVBoxLayout, 
                               QWidget, QToolBar, QSplitter, QPushButton,
                               QFileDialog, QMessageBox, QStatusBar, QLabel,
                               QGraphicsDropShadowEffect)
from PySide6.QtCore import Qt, QTimer
from PySide6.QtGui import QAction, QIcon, QColor
from src.ui.editor_widget import EditorWidget
from src.ui.preview_widget import PreviewWidget

class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        
        # å…ˆåˆ›å»ºè‡ªåŠ¨æ›´æ–°è®¡æ—¶å™¨
        self.update_timer = QTimer()
        self.update_timer.timeout.connect(self.update_preview)
        self.update_timer.setInterval(300)  # 300mså»¶è¿Ÿ
        
        # ç„¶ååˆå§‹åŒ–UI
        self.init_ui()
        self.setup_connections()
        
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        self.setWindowTitle("ğŸ“ å°çº¢ä¹¦ Markdown ç¼–è¾‘å™¨")
        self.setGeometry(100, 100, 1700, 950)
        
        # è®¾ç½®çª—å£æ ·å¼ - æ·±è‰²ç§‘æŠ€é£èƒŒæ™¯
        self.setStyleSheet("""
            QMainWindow {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 1,
                    stop: 0 #0f0f1e,
                    stop: 0.5 #1a1a2e, 
                    stop: 1 #16213e
                );
            }
        """)
        
        # åˆ›å»ºå·¥å…·æ 
        toolbar = QToolBar()
        toolbar.setMovable(False)
        toolbar.setFixedHeight(65)
        toolbar.setStyleSheet("""
            QToolBar {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(30, 30, 45, 0.95),
                    stop: 1 rgba(20, 20, 35, 0.98)
                );
                border: none;
                border-bottom: 2px solid rgba(0, 224, 255, 0.3);
                padding: 10px 15px;
                spacing: 12px;
            }
            QToolButton {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.15),
                    stop: 1 rgba(0, 150, 255, 0.1)
                );
                border: 1px solid rgba(0, 224, 255, 0.4);
                border-radius: 10px;
                padding: 10px 20px;
                color: #00e0ff;
                font-weight: 600;
                font-size: 14px;
                margin: 0 5px;
                letter-spacing: 0.5px;
                min-width: 120px;
            }
            QToolButton:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.25),
                    stop: 1 rgba(0, 150, 255, 0.2)
                );
                border: 1px solid rgba(0, 224, 255, 0.6);
                color: #00f0ff;
            }
            QToolButton:pressed {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.35),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
                border: 1px solid #00e0ff;
                color: white;
            }
        """)
        self.addToolBar(toolbar)
        
        # æ·»åŠ å·¥å…·æ æŒ‰é’®
        export_action = QAction("ğŸ“¸ å¯¼å‡ºå›¾ç‰‡", self)
        export_action.triggered.connect(self.export_images)
        toolbar.addAction(export_action)
        
        toolbar.addSeparator()
        
        clear_action = QAction("ğŸ—‘ï¸ æ¸…ç©ºå†…å®¹", self)
        clear_action.triggered.connect(self.clear_content)
        toolbar.addAction(clear_action)
        
        # åˆ›å»ºçŠ¶æ€æ 
        self.status_bar = QStatusBar()
        self.status_bar.setFixedHeight(35)
        self.status_bar.setStyleSheet("""
            QStatusBar {
                background: rgba(20, 20, 35, 0.95);
                color: #8a92a6;
                border-top: 1px solid rgba(0, 224, 255, 0.2);
                padding: 6px 15px;
                font-size: 13px;
            }
            QStatusBar::item {
                border: none;
            }
        """)
        self.setStatusBar(self.status_bar)
        
        # æ·»åŠ çŠ¶æ€æ ä¿¡æ¯
        self.char_count_label = QLabel("å­—æ•°: 0")
        self.char_count_label.setStyleSheet("""
            QLabel {
                color: #00e0ff;
                font-weight: 500;
                padding: 4px 12px;
                background: rgba(0, 224, 255, 0.1);
                border: 1px solid rgba(0, 224, 255, 0.3);
                border-radius: 12px;
            }
        """)
        self.status_bar.addPermanentWidget(self.char_count_label)
        
        # åˆ›å»ºä¸­å¿ƒéƒ¨ä»¶
        central_widget = QWidget()
        central_widget.setStyleSheet("""
            QWidget {
                background: transparent;
            }
        """)
        self.setCentralWidget(central_widget)
        
        # åˆ›å»ºå¸ƒå±€
        layout = QHBoxLayout(central_widget)
        layout.setContentsMargins(25, 25, 25, 25)
        layout.setSpacing(20)
        
        # åˆ›å»ºåˆ†å‰²å™¨
        splitter = QSplitter(Qt.Horizontal)
        splitter.setStyleSheet("""
            QSplitter::handle {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.2),
                    stop: 0.5 rgba(0, 224, 255, 0.4),
                    stop: 1 rgba(0, 224, 255, 0.2)
                );
                width: 3px;
                border-radius: 1px;
            }
            QSplitter::handle:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.3),
                    stop: 0.5 rgba(0, 224, 255, 0.6),
                    stop: 1 rgba(0, 224, 255, 0.3)
                );
            }
        """)
        
        # åˆ›å»ºç¼–è¾‘å™¨å’Œé¢„è§ˆç»„ä»¶
        self.editor = EditorWidget()
        self.preview = PreviewWidget()
        
        # æ·»åŠ é˜´å½±æ•ˆæœ
        self.add_shadow_effect(self.editor)
        self.add_shadow_effect(self.preview)
        
        # æ·»åŠ åˆ°åˆ†å‰²å™¨
        splitter.addWidget(self.editor)
        splitter.addWidget(self.preview)
        splitter.setSizes([850, 850])  # è®¾ç½®åˆå§‹å®½åº¦
        
        layout.addWidget(splitter)
        
        # åˆå§‹æ›´æ–°
        self.update_preview()
        self.update_char_count()
    
    def add_shadow_effect(self, widget):
        """ä¸ºç»„ä»¶æ·»åŠ é˜´å½±æ•ˆæœ"""
        shadow = QGraphicsDropShadowEffect()
        shadow.setBlurRadius(30)
        shadow.setXOffset(0)
        shadow.setYOffset(5)
        shadow.setColor(QColor(0, 224, 255, 50))
        widget.setGraphicsEffect(shadow)
        
    def setup_connections(self):
        """è®¾ç½®ä¿¡å·è¿æ¥"""
        self.editor.textChanged.connect(self.on_text_changed)
        self.editor.scrollChanged.connect(self.preview.handle_scroll)
        self.preview.pageChanged.connect(self.on_page_changed)
        
    def on_text_changed(self):
        """æ–‡æœ¬æ”¹å˜æ—¶å¯åŠ¨è®¡æ—¶å™¨"""
        self.update_timer.stop()
        self.update_timer.start()
        self.update_char_count()
        
    def update_preview(self):
        """æ›´æ–°é¢„è§ˆ"""
        self.update_timer.stop()
        markdown_text = self.editor.get_text()
        self.preview.update_content(markdown_text)
        
    def update_char_count(self):
        """æ›´æ–°å­—æ•°ç»Ÿè®¡"""
        text = self.editor.get_text()
        char_count = len(text.replace(" ", "").replace("\n", ""))
        self.char_count_label.setText(f"å­—æ•°: {char_count}")
        
    def on_page_changed(self, current, total):
        """é¡µç æ”¹å˜æ—¶æ›´æ–°çŠ¶æ€æ """
        self.status_bar.showMessage(f"é¡µé¢: {current}/{total}", 2000)
        
    def clear_content(self):
        """æ¸…ç©ºå†…å®¹"""
        reply = QMessageBox.question(
            self, "ç¡®è®¤æ¸…ç©º",
            "ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†…å®¹å—ï¼Ÿ",
            QMessageBox.Yes | QMessageBox.No,
            QMessageBox.No
        )
        
        if reply == QMessageBox.Yes:
            self.editor.editor.clear()
            
    def export_images(self):
        """å¯¼å‡ºå›¾ç‰‡"""
        folder = QFileDialog.getExistingDirectory(self, "é€‰æ‹©å¯¼å‡ºæ–‡ä»¶å¤¹")
        if folder:
            try:
                self.preview.export_pages(folder)
                QMessageBox.information(
                    self, "å¯¼å‡ºæˆåŠŸ",
                    f"å›¾ç‰‡å·²æˆåŠŸå¯¼å‡ºåˆ°:\n{folder}",
                    QMessageBox.Ok
                )
            except Exception as e:
                QMessageBox.critical(
                    self, "å¯¼å‡ºå¤±è´¥",
                    f"å¯¼å‡ºè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯:\n{str(e)}",
                    QMessageBox.Ok
                ) preview_widget.py->text/plain-># ============================================
# src/ui/preview_widget.py
# ============================================
from PySide6.QtWidgets import (QWidget, QVBoxLayout, QLabel, QFrame, 
                               QPushButton, QHBoxLayout, QProgressDialog,
                               QMessageBox, QScrollArea, QSlider)
from PySide6.QtWebEngineWidgets import QWebEngineView
from PySide6.QtCore import QUrl, QTimer, Signal, Qt, QSize
from pathlib import Path
from src.core.markdown_processor import MarkdownProcessor
from src.core.html_generator import HTMLGenerator
from src.utils.paginator import SmartPaginator
from src.utils.exporter import ImageExporter

class PreviewWidget(QWidget):
    pageChanged = Signal(int, int)  # å½“å‰é¡µï¼Œæ€»é¡µæ•°
    
    def __init__(self):
        super().__init__()
        self.current_pages = []  # å­˜å‚¨åˆ†é¡µåçš„HTMLå†…å®¹
        self.current_page = 1
        self.total_pages = 1
        self.markdown_text = ""  # ä¿å­˜åŸå§‹markdownæ–‡æœ¬
        self.current_zoom = 1.0  # å½“å‰ç¼©æ”¾æ¯”ä¾‹
        self.init_ui()
        self.setup_exporter()
        
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        layout.setContentsMargins(0, 0, 0, 0)
        layout.setSpacing(0)
        
        # åˆ›å»ºå®¹å™¨æ¡†æ¶
        container = QFrame()
        container.setStyleSheet("""
            QFrame {
                background: rgba(25, 25, 40, 0.95);
                border: 1px solid rgba(0, 224, 255, 0.2);
                border-radius: 16px;
            }
        """)
        container_layout = QVBoxLayout(container)
        container_layout.setContentsMargins(0, 0, 0, 0)
        container_layout.setSpacing(0)
        
        # æ ‡é¢˜æ 
        title_bar = QFrame()
        title_bar.setFixedHeight(50)
        title_bar.setStyleSheet("""
            QFrame {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.1),
                    stop: 0.5 rgba(0, 150, 255, 0.15),
                    stop: 1 rgba(0, 224, 255, 0.1)
                );
                border-top-left-radius: 16px;
                border-top-right-radius: 16px;
                border-bottom: 1px solid rgba(0, 224, 255, 0.2);
                padding: 12px 20px;
            }
        """)
        title_layout = QHBoxLayout(title_bar)
        
        title = QLabel("ğŸ‘€ å®æ—¶é¢„è§ˆ")
        title.setStyleSheet("""
            QLabel {
                color: #00e0ff;
                font-size: 16px;
                font-weight: 600;
                letter-spacing: 0.5px;
            }
        """)
        
        # ç¼©æ”¾æ˜¾ç¤ºæ ‡ç­¾
        self.zoom_label = QLabel("100%")
        self.zoom_label.setStyleSheet("""
            QLabel {
                color: #8a92a6;
                font-size: 12px;
                padding: 0 10px;
            }
        """)
        
        title_layout.addWidget(title)
        title_layout.addStretch()
        title_layout.addWidget(self.zoom_label)
        
        # åˆ›å»ºæ»šåŠ¨åŒºåŸŸæ¥åŒ…å« WebViewï¼ˆå›ºå®šå°ºå¯¸ï¼‰
        self.scroll_area = QScrollArea()
        self.scroll_area.setStyleSheet("""
            QScrollArea {
                border: none;
                background: #2a2a3e;
            }
            QScrollBar:vertical {
                background: rgba(20, 20, 35, 0.5);
                width: 12px;
                border-radius: 6px;
                margin: 5px;
            }
            QScrollBar::handle:vertical {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.4),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
                border-radius: 6px;
                min-height: 30px;
            }
            QScrollBar::handle:vertical:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.6),
                    stop: 1 rgba(0, 150, 255, 0.5)
                );
            }
            QScrollBar::add-line:vertical,
            QScrollBar::sub-line:vertical {
                border: none;
                background: none;
                height: 0;
            }
            QScrollBar:horizontal {
                background: rgba(20, 20, 35, 0.5);
                height: 12px;
                border-radius: 6px;
                margin: 5px;
            }
            QScrollBar::handle:horizontal {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.4),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
                border-radius: 6px;
                min-width: 30px;
            }
            QScrollBar::handle:horizontal:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.6),
                    stop: 1 rgba(0, 150, 255, 0.5)
                );
            }
            QScrollBar::add-line:horizontal,
            QScrollBar::sub-line:horizontal {
                border: none;
                background: none;
                width: 0;
            }
        """)
        
        # Webè§†å›¾ - è®¾ç½®å›ºå®šå°ºå¯¸
        self.web_view = QWebEngineView()
        # è®¾ç½®å›ºå®šå°ºå¯¸ä¸ºå°çº¢ä¹¦å¡ç‰‡å°ºå¯¸
        self.web_view.setFixedSize(1080, 1440)
        self.web_view.setStyleSheet("""
            QWebEngineView {
                border: none;
                background: white;
            }
        """)
        
        # ç¦ç”¨ WebView çš„æ»šåŠ¨æ¡
        self.web_view.page().settings().setAttribute(
            self.web_view.page().settings().WebAttribute.ShowScrollBars, False
        )
        
        # è®¾ç½®æ»šåŠ¨åŒºåŸŸ
        self.scroll_area.setWidget(self.web_view)
        self.scroll_area.setWidgetResizable(False)  # ä¸è‡ªåŠ¨è°ƒæ•´å¤§å°
        self.scroll_area.setHorizontalScrollBarPolicy(Qt.ScrollBarAsNeeded)
        self.scroll_area.setVerticalScrollBarPolicy(Qt.ScrollBarAsNeeded)
        self.scroll_area.setAlignment(Qt.AlignCenter)  # å±…ä¸­æ˜¾ç¤º
        
        # ç¿»é¡µæ§åˆ¶æ 
        control_bar = QFrame()
        control_bar.setFixedHeight(60)
        control_bar.setStyleSheet("""
            QFrame {
                background: rgba(20, 20, 35, 0.8);
                padding: 10px 20px;
                border-bottom-left-radius: 16px;
                border-bottom-right-radius: 16px;
                border-top: 1px solid rgba(0, 224, 255, 0.1);
            }
        """)
        control_layout = QHBoxLayout(control_bar)
        
        self.prev_btn = QPushButton("â¬… ä¸Šä¸€é¡µ")
        self.prev_btn.setFixedSize(100, 36)
        self.prev_btn.setStyleSheet(self.get_button_style())
        
        self.next_btn = QPushButton("ä¸‹ä¸€é¡µ â¡")
        self.next_btn.setFixedSize(100, 36)
        self.next_btn.setStyleSheet(self.get_button_style())
        
        # ç¼©æ”¾æ»‘å—
        self.zoom_slider = QSlider(Qt.Horizontal)
        self.zoom_slider.setRange(25, 150)  # 25% - 150%
        self.zoom_slider.setValue(100)  # é»˜è®¤100%
        self.zoom_slider.setFixedWidth(200)
        self.zoom_slider.setStyleSheet("""
            QSlider::groove:horizontal {
                height: 6px;
                background: rgba(0, 224, 255, 0.2);
                border-radius: 3px;
            }
            QSlider::handle:horizontal {
                width: 18px;
                height: 18px;
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 #00e0ff,
                    stop: 1 #0096ff
                );
                border-radius: 9px;
                margin: -6px 0;
            }
            QSlider::handle:horizontal:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 #00f0ff,
                    stop: 1 #00a6ff
                );
            }
        """)
        
        # ç¼©æ”¾æŒ‰é’®
        self.zoom_fit_btn = QPushButton("ğŸ” é€‚åº”çª—å£")
        self.zoom_fit_btn.setFixedSize(100, 36)
        self.zoom_fit_btn.setStyleSheet(self.get_button_style())
        
        self.zoom_100_btn = QPushButton("ğŸ“ 100%")
        self.zoom_100_btn.setFixedSize(80, 36)
        self.zoom_100_btn.setStyleSheet(self.get_button_style())
        
        control_layout.addWidget(self.prev_btn)
        control_layout.addSpacing(20)
        control_layout.addWidget(QLabel("ç¼©æ”¾:", styleSheet="color: #8a92a6;"))
        control_layout.addWidget(self.zoom_slider)
        control_layout.addWidget(self.zoom_100_btn)
        control_layout.addWidget(self.zoom_fit_btn)
        control_layout.addStretch()
        control_layout.addWidget(self.next_btn)
        
        # ç»„è£…å¸ƒå±€
        container_layout.addWidget(title_bar)
        container_layout.addWidget(self.scroll_area, 1)
        container_layout.addWidget(control_bar)
        
        layout.addWidget(container)
        
        # å¤„ç†å™¨
        self.markdown_processor = MarkdownProcessor()
        self.html_generator = HTMLGenerator()
        self.paginator = SmartPaginator()
        
        # è¿æ¥ä¿¡å·
        self.prev_btn.clicked.connect(self.prev_page)
        self.next_btn.clicked.connect(self.next_page)
        self.zoom_slider.valueChanged.connect(self.on_zoom_changed)
        self.zoom_fit_btn.clicked.connect(self.zoom_to_fit)
        self.zoom_100_btn.clicked.connect(self.zoom_to_100)
        
        # åˆå§‹åŒ–æŒ‰é’®çŠ¶æ€
        self.update_buttons()
        
        # å»¶è¿Ÿè‡ªé€‚åº”ï¼ˆç­‰å¾…çª—å£å®Œå…¨åŠ è½½ï¼‰
        QTimer.singleShot(500, self.zoom_to_fit)
    
    def get_button_style(self) -> str:
        """è·å–æŒ‰é’®æ ·å¼"""
        return """
            QPushButton {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.15),
                    stop: 1 rgba(0, 150, 255, 0.1)
                );
                border: 1px solid rgba(0, 224, 255, 0.4);
                color: #00e0ff;
                padding: 8px 16px;
                border-radius: 8px;
                font-weight: 600;
                font-size: 13px;
            }
            QPushButton:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.25),
                    stop: 1 rgba(0, 150, 255, 0.2)
                );
                border: 1px solid rgba(0, 224, 255, 0.6);
            }
            QPushButton:pressed {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.35),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
            }
            QPushButton:disabled {
                background: rgba(30, 30, 45, 0.5);
                border-color: rgba(100, 100, 120, 0.3);
                color: rgba(100, 100, 120, 0.5);
            }
        """
    
    def on_zoom_changed(self, value):
        """å¤„ç†ç¼©æ”¾æ»‘å—å˜åŒ–"""
        zoom = value / 100.0
        self.set_zoom(zoom)
    
    def set_zoom(self, zoom_factor):
        """è®¾ç½®ç¼©æ”¾æ¯”ä¾‹"""
        self.current_zoom = zoom_factor
        self.web_view.setZoomFactor(zoom_factor)
        self.zoom_label.setText(f"{int(zoom_factor * 100)}%")
        
        # ä¸éœ€è¦æ”¹å˜æ»‘å—å€¼æ—¶çš„ä¿¡å·é˜»å¡
        self.zoom_slider.blockSignals(True)
        self.zoom_slider.setValue(int(zoom_factor * 100))
        self.zoom_slider.blockSignals(False)
    
    def zoom_to_fit(self):
        """ç¼©æ”¾åˆ°é€‚åº”çª—å£"""
        if self.scroll_area and self.web_view:
            # è·å–æ»šåŠ¨åŒºåŸŸçš„å¯è§†å¤§å°
            viewport_size = self.scroll_area.viewport().size()
            
            # å¡ç‰‡å›ºå®šå°ºå¯¸
            card_width = 1080
            card_height = 1440
            
            # è®¡ç®—ç¼©æ”¾æ¯”ä¾‹ï¼ˆç•™å‡ºä¸€äº›è¾¹è·ï¼‰
            margin = 20
            scale_x = (viewport_size.width() - margin * 2) / card_width
            scale_y = (viewport_size.height() - margin * 2) / card_height
            scale = min(scale_x, scale_y, 1.0)  # ä¸è¶…è¿‡100%
            
            # åº”ç”¨ç¼©æ”¾
            self.set_zoom(scale)
    
    def zoom_to_100(self):
        """æ¢å¤100%å¤§å°"""
        self.set_zoom(1.0)
    
    def setup_exporter(self):
        """è®¾ç½®å¯¼å‡ºå™¨"""
        self.exporter = ImageExporter(self.web_view)
        self.exporter.progress.connect(self.on_export_progress)
        self.exporter.finished.connect(self.on_export_finished)
        self.exporter.page_exported.connect(self.on_page_exported)
        
    def update_content(self, markdown_text: str):
        """æ›´æ–°é¢„è§ˆå†…å®¹"""
        try:
            self.markdown_text = markdown_text
            
            # å¤„ç† Markdown
            html_content = self.markdown_processor.parse(markdown_text)
            
            # ä½¿ç”¨æ™ºèƒ½åˆ†é¡µå™¨è¿›è¡Œåˆ†é¡µ
            self.current_pages = self.paginator.paginate(html_content)
            
            # ä¼˜åŒ–åˆ†é¡µç»“æœ
            self.current_pages = self.paginator.optimize_pages(self.current_pages)
            
            self.total_pages = len(self.current_pages)
            self.current_page = 1
            
            # æ˜¾ç¤ºç¬¬ä¸€é¡µ
            self.display_current_page()
            
            # æ›´æ–°æŒ‰é’®
            self.update_buttons()
            
            # ä¿æŒå½“å‰ç¼©æ”¾æ¯”ä¾‹
            QTimer.singleShot(100, lambda: self.set_zoom(self.current_zoom))
            
        except Exception as e:
            self.show_error(f"é¢„è§ˆé”™è¯¯: {str(e)}")
    
    def display_current_page(self):
        """æ˜¾ç¤ºå½“å‰é¡µ"""
        if not self.current_pages:
            return
            
        if 1 <= self.current_page <= len(self.current_pages):
            page_content = self.current_pages[self.current_page - 1]
            
            # ç”Ÿæˆå®Œæ•´HTML
            full_html = self.html_generator.generate(page_content)
            
            # åŠ è½½åˆ°WebView
            self.web_view.setHtml(full_html, QUrl("file:///"))
    
    def prev_page(self):
        """ä¸Šä¸€é¡µ"""
        if self.current_page > 1:
            self.current_page -= 1
            self.display_current_page()
            self.update_buttons()
    
    def next_page(self):
        """ä¸‹ä¸€é¡µ"""
        if self.current_page < self.total_pages:
            self.current_page += 1
            self.display_current_page()
            self.update_buttons()
    
    def update_buttons(self):
        """æ›´æ–°æŒ‰é’®çŠ¶æ€"""
        self.prev_btn.setEnabled(self.current_page > 1)
        self.next_btn.setEnabled(self.current_page < self.total_pages)
        
        # æ›´æ–°æ ‡é¢˜æ æ˜¾ç¤ºï¼ˆå¦‚æœæœ‰å¤šé¡µï¼‰
        if self.total_pages > 1:
            page_info = f" (ç¬¬ {self.current_page}/{self.total_pages} é¡µ)"
            # å¯ä»¥å°†é¡µç ä¿¡æ¯æ·»åŠ åˆ°æ ‡é¢˜æ 
    
    def export_pages(self, folder: str):
        """å¯¼å‡ºæ‰€æœ‰é¡µé¢ä¸ºå›¾ç‰‡"""
        if not self.current_pages:
            QMessageBox.warning(self, "æç¤º", "æ²¡æœ‰å¯å¯¼å‡ºçš„å†…å®¹")
            return
        
        # åˆ›å»ºè¿›åº¦å¯¹è¯æ¡†
        self.progress_dialog = QProgressDialog(
            "æ­£åœ¨å¯¼å‡ºå›¾ç‰‡...", 
            "å–æ¶ˆ", 
            0, 
            self.total_pages, 
            self
        )
        self.progress_dialog.setWindowModality(Qt.WindowModal)
        self.progress_dialog.setMinimumDuration(0)
        self.progress_dialog.canceled.connect(self.on_export_canceled)
        
        # å¯¼å‡ºå‰æ¢å¤100%å¤§å°ï¼ˆç¡®ä¿å¯¼å‡ºçš„æ˜¯åŸå§‹å°ºå¯¸ï¼‰
        original_zoom = self.current_zoom
        self.web_view.setZoomFactor(1.0)
        
        # å¼€å§‹å¯¼å‡º
        self.exporter.export_pages(
            self.current_pages,
            folder,
            self.html_generator,
            format="PNG",
            quality=100
        )
        
        # ä¿å­˜åŸå§‹ç¼©æ”¾æ¯”ä¾‹ï¼Œå¯¼å‡ºå®Œæˆåæ¢å¤
        self._original_zoom_for_export = original_zoom
    
    def on_export_progress(self, current: int, total: int):
        """å¤„ç†å¯¼å‡ºè¿›åº¦"""
        if hasattr(self, 'progress_dialog'):
            self.progress_dialog.setValue(current)
            self.progress_dialog.setLabelText(f"æ­£åœ¨å¯¼å‡ºç¬¬ {current}/{total} é¡µ...")
    
    def on_export_finished(self, success: bool, message: str):
        """å¤„ç†å¯¼å‡ºå®Œæˆ"""
        # å…³é—­è¿›åº¦å¯¹è¯æ¡†
        if hasattr(self, 'progress_dialog') and self.progress_dialog is not None:
            try:
                self.progress_dialog.close()
                self.progress_dialog.deleteLater()
            except:
                pass
            finally:
                self.progress_dialog = None
        
        # æ¢å¤åŸå§‹ç¼©æ”¾æ¯”ä¾‹
        if hasattr(self, '_original_zoom_for_export'):
            self.set_zoom(self._original_zoom_for_export)
            delattr(self, '_original_zoom_for_export')
        
        if success:
            QMessageBox.information(self, "å¯¼å‡ºæˆåŠŸ", message)
        else:
            QMessageBox.warning(self, "å¯¼å‡ºå¤±è´¥", message)
    
    def on_page_exported(self, page_num: int, file_path: str):
        """å¤„ç†å•é¡µå¯¼å‡ºå®Œæˆ"""
        print(f"å·²å¯¼å‡ºç¬¬ {page_num} é¡µ: {file_path}")
    
    def on_export_canceled(self):
        """å¤„ç†å¯¼å‡ºå–æ¶ˆ"""
        self.exporter.cancel_export()
        # æ¢å¤åŸå§‹ç¼©æ”¾
        if hasattr(self, '_original_zoom_for_export'):
            self.set_zoom(self._original_zoom_for_export)
            delattr(self, '_original_zoom_for_export')
    
    def handle_scroll(self, percentage: float):
        """å¤„ç†ç¼–è¾‘å™¨æ»šåŠ¨åŒæ­¥"""
        # å›ºå®šå°ºå¯¸ï¼Œä¸éœ€è¦æ»šåŠ¨åŒæ­¥
        pass
    
    def show_error(self, message: str):
        """æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯"""
        error_html = f"""
        <html>
        <body style="padding: 20px; font-family: sans-serif; background: #1a1a2e; color: #e0e6ed;">
            <h3 style="color: #ff4757;">é”™è¯¯</h3>
            <p style="color: #8a92a6;">{message}</p>
        </body>
        </html>
        """
        self.web_view.setHtml(error_html) exporter.py->text/plain-># ============================================
# src/utils/exporter.py
# ============================================
from PySide6.QtCore import QObject, Signal, QTimer, QEventLoop, QSize, Qt, QPoint, QRect
from PySide6.QtGui import QImage, QPainter, QFont, QColor, QPageSize, QRegion
from PySide6.QtWebEngineWidgets import QWebEngineView
from PySide6.QtPrintSupport import QPrinter
from PySide6.QtWidgets import QWidget
from pathlib import Path
from typing import List, Optional
import json
import time

class ImageExporter(QObject):
    """å›¾ç‰‡å¯¼å‡ºå™¨"""
    
    # ä¿¡å·
    progress = Signal(int, int)  # å½“å‰è¿›åº¦ï¼Œæ€»æ•°
    finished = Signal(bool, str)  # æ˜¯å¦æˆåŠŸï¼Œæ¶ˆæ¯
    page_exported = Signal(int, str)  # é¡µç ï¼Œæ–‡ä»¶è·¯å¾„
    
    def __init__(self, web_view: QWebEngineView):
        super().__init__()
        self.web_view = web_view
        self.pages_to_export = []
        self.current_export_index = 0
        self.output_folder = ""
        self.html_generator = None
        self.export_format = "PNG"
        self.quality = 100
        self._is_exporting = False
        
    def export_pages(self, pages: List[str], output_folder: str, html_generator, 
                     format: str = "PNG", quality: int = 100) -> None:
        """
        å¯¼å‡ºå¤šä¸ªé¡µé¢ä¸ºå›¾ç‰‡
        
        Args:
            pages: HTMLé¡µé¢å†…å®¹åˆ—è¡¨
            output_folder: è¾“å‡ºæ–‡ä»¶å¤¹è·¯å¾„
            html_generator: HTMLç”Ÿæˆå™¨å®ä¾‹
            format: å›¾ç‰‡æ ¼å¼ (PNG/JPEG)
            quality: å›¾ç‰‡è´¨é‡ (1-100)
        """
        self.pages_to_export = pages
        self.output_folder = Path(output_folder)
        self.current_export_index = 0
        self.html_generator = html_generator
        self.export_format = format
        self.quality = quality
        self._is_exporting = True
        
        # ç¡®ä¿è¾“å‡ºæ–‡ä»¶å¤¹å­˜åœ¨
        self.output_folder.mkdir(parents=True, exist_ok=True)
        
        # ç¡®ä¿WebViewæ˜¯å›ºå®šå°ºå¯¸
        self.web_view.setFixedSize(1080, 1440)
        self.web_view.setZoomFactor(1.0)  # é‡ç½®ç¼©æ”¾
        
        # å¼€å§‹å¯¼å‡ºç¬¬ä¸€é¡µ
        self._export_next_page()
    
    def _export_next_page(self):
        """å¯¼å‡ºä¸‹ä¸€é¡µ"""
        if not self._is_exporting:
            return
            
        if self.current_export_index >= len(self.pages_to_export):
            # å¯¼å‡ºå®Œæˆ
            self._is_exporting = False
            self.finished.emit(True, f"æˆåŠŸå¯¼å‡º {len(self.pages_to_export)} å¼ å›¾ç‰‡")
            return
        
        # å‘é€è¿›åº¦ä¿¡å·
        self.progress.emit(self.current_export_index + 1, len(self.pages_to_export))
        
        # è·å–å½“å‰é¡µå†…å®¹
        page_content = self.pages_to_export[self.current_export_index]
        page_num = self.current_export_index + 1
        
        # ç”Ÿæˆå®Œæ•´HTMLï¼ˆåŒ…å«é¡µç ä¿¡æ¯ï¼‰
        full_html = self.html_generator.generate(
            page_content, 
            page_num=page_num, 
            total_pages=len(self.pages_to_export)
        )
        
        # åŠ è½½HTMLåˆ°WebView
        self.web_view.setHtml(full_html, "file:///")
        
        # ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆåå¯¼å‡º
        QTimer.singleShot(1500, lambda: self._capture_page(page_num))
    
    def _capture_page(self, page_num: int):
        """æ•è·å½“å‰é¡µé¢ä¸ºå›¾ç‰‡"""
        if not self._is_exporting:
            return
            
        # æ„å»ºè¾“å‡ºæ–‡ä»¶å
        extension = self.export_format.lower()
        filename = f"card_{page_num:02d}.{extension}"
        output_path = self.output_folder / filename
        
        # ä½¿ç”¨ç²¾ç¡®çš„æ•è·æ–¹æ³•
        self._capture_fixed_size(output_path, page_num)
    
    def _capture_fixed_size(self, output_path: Path, page_num: int):
        """æ•è·å›ºå®šå°ºå¯¸çš„é¡µé¢"""
        try:
            # åˆ›å»ºç²¾ç¡®å°ºå¯¸çš„å›¾ç‰‡ï¼ˆå°çº¢ä¹¦å¡ç‰‡å°ºå¯¸ï¼‰
            target_width = 1080
            target_height = 1440
            
            # åˆ›å»ºç›®æ ‡å›¾ç‰‡
            image = QImage(target_width, target_height, QImage.Format_ARGB32)
            image.fill(Qt.white)
            
            # åˆ›å»ºpainter
            painter = QPainter(image)
            painter.setRenderHint(QPainter.RenderHint.Antialiasing, True)
            painter.setRenderHint(QPainter.RenderHint.TextAntialiasing, True)
            painter.setRenderHint(QPainter.RenderHint.SmoothPixmapTransform, True)
            
            # ç¡®ä¿WebViewæ˜¯æ­£ç¡®çš„å°ºå¯¸
            self.web_view.resize(target_width, target_height)
            
            # æ¸²æŸ“WebViewåˆ°å›¾ç‰‡
            # ä½¿ç”¨å›ºå®šçš„æºçŸ©å½¢æ¥ç¡®ä¿åªæ•è·å¡ç‰‡åŒºåŸŸ
            source_rect = QRect(0, 0, target_width, target_height)
            target_rect = QRect(0, 0, target_width, target_height)
            
            # æ¸²æŸ“WebView
            if isinstance(self.web_view, QWidget):
                self.web_view.render(
                    painter,
                    QPoint(0, 0),
                    QRegion(source_rect),
                    QWidget.RenderFlag.DrawWindowBackground | QWidget.RenderFlag.DrawChildren
                )
            
            # å¯é€‰ï¼šæ·»åŠ å¯¼å‡ºæ—¶é—´æ°´å°
            self._add_export_watermark(painter, page_num)
            
            painter.end()
            
            # ä¿å­˜å›¾ç‰‡
            success = image.save(str(output_path), self.export_format, self.quality)
            
            if success:
                self.page_exported.emit(page_num, str(output_path))
                # ç»§ç»­å¯¼å‡ºä¸‹ä¸€é¡µ
                self.current_export_index += 1
                QTimer.singleShot(100, self._export_next_page)
            else:
                self._is_exporting = False
                self.finished.emit(False, f"ä¿å­˜å›¾ç‰‡å¤±è´¥: {output_path}")
                
        except Exception as e:
            self._is_exporting = False
            self.finished.emit(False, f"å¯¼å‡ºé¡µé¢ {page_num} æ—¶å‡ºé”™: {str(e)}")
    
    def _add_export_watermark(self, painter: QPainter, page_num: int):
        """æ·»åŠ å¯¼å‡ºæ°´å°ï¼ˆå¯é€‰ï¼‰"""
        # è®¾ç½®æ°´å°å­—ä½“å’Œé¢œè‰²
        font = QFont("Arial", 9)
        painter.setFont(font)
        painter.setPen(QColor(200, 200, 200, 80))
        
        # åœ¨å³ä¸‹è§’æ·»åŠ ç”Ÿæˆæ—¶é—´ï¼ˆéå¸¸æ·¡çš„æ°´å°ï¼‰
        timestamp = time.strftime("%Y%m%d")
        painter.drawText(
            1000, 1420,
            f"{timestamp}"
        )
    
    def export_as_pdf(self, pages: List[str], output_file: str, html_generator):
        """
        å¯¼å‡ºä¸ºPDFæ–‡ä»¶ï¼ˆæ‰€æœ‰é¡µé¢åˆå¹¶ä¸ºä¸€ä¸ªPDFï¼‰
        
        Args:
            pages: HTMLé¡µé¢å†…å®¹åˆ—è¡¨
            output_file: è¾“å‡ºPDFæ–‡ä»¶è·¯å¾„
            html_generator: HTMLç”Ÿæˆå™¨å®ä¾‹
        """
        try:
            # åˆ›å»ºPDFæ‰“å°æœº
            printer = QPrinter(QPrinter.PrinterMode.HighResolution)
            printer.setOutputFormat(QPrinter.OutputFormat.PdfFormat)
            printer.setOutputFileName(output_file)
            
            # è®¾ç½®é¡µé¢å¤§å°ä¸ºå°çº¢ä¹¦å¡ç‰‡æ¯”ä¾‹
            # æ³¨æ„ï¼šPDFä½¿ç”¨ç‚¹(point)ä½œä¸ºå•ä½ï¼Œ1ç‚¹ = 1/72è‹±å¯¸
            # 1080px Ã— 1440px åœ¨ 96 DPI ä¸‹çº¦ç­‰äº 810pt Ã— 1080pt
            page_size = QPageSize(QSize(810, 1080), QPageSize.Unit.Point)
            printer.setPageSize(page_size)
            printer.setPageMargins(0, 0, 0, 0, QPrinter.Unit.Millimeter)
            
            # åˆå¹¶æ‰€æœ‰é¡µé¢å†…å®¹
            combined_html = self._combine_pages_for_pdf(pages, html_generator)
            
            # åŠ è½½åˆå¹¶åçš„HTML
            self.web_view.setHtml(combined_html, "file:///")
            
            # ç­‰å¾…åŠ è½½å®Œæˆåæ‰“å°
            loop = QEventLoop()
            
            def on_load_finished():
                self.web_view.page().print(printer, lambda success: loop.quit())
            
            QTimer.singleShot(1000, on_load_finished)
            loop.exec()
            
            self.finished.emit(True, f"PDFå¯¼å‡ºæˆåŠŸ: {output_file}")
            
        except Exception as e:
            self.finished.emit(False, f"PDFå¯¼å‡ºå¤±è´¥: {str(e)}")
    
    def _combine_pages_for_pdf(self, pages: List[str], html_generator) -> str:
        """åˆå¹¶å¤šä¸ªé¡µé¢ä¸ºPDFæ ¼å¼"""
        combined_content = ""
        
        for i, page in enumerate(pages, 1):
            if i > 1:
                # æ·»åŠ åˆ†é¡µç¬¦
                combined_content += '<div style="page-break-before: always;"></div>'
            
            # æ·»åŠ é¡µé¢å†…å®¹ï¼ŒåŒ…è£…åœ¨å›ºå®šå°ºå¯¸çš„å®¹å™¨ä¸­
            combined_content += f'''
            <div style="width: 1080px; height: 1440px; position: relative; overflow: hidden;">
                {page}
            </div>
            '''
        
        # ç”Ÿæˆå®Œæ•´HTML
        return html_generator.generate(combined_content)
    
    def cancel_export(self):
        """å–æ¶ˆå¯¼å‡º"""
        self._is_exporting = False
        self.pages_to_export = []
        self.finished.emit(False, "å¯¼å‡ºå·²å–æ¶ˆ") paginator.py->text/plain-># ============================================
# src/utils/paginator.py
# ============================================
from typing import List, Tuple, Optional
from dataclasses import dataclass
from bs4 import BeautifulSoup, NavigableString, Tag
import re

@dataclass
class PageElement:
    """é¡µé¢å…ƒç´ """
    type: str  # 'heading', 'paragraph', 'list', 'code', 'blockquote', 'table', 'hr', 'text'
    content: str  # HTMLå†…å®¹
    text: str  # çº¯æ–‡æœ¬å†…å®¹ï¼ˆç”¨äºè®¡ç®—é«˜åº¦ï¼‰
    level: int = 0  # æ ‡é¢˜çº§åˆ«æˆ–åµŒå¥—æ·±åº¦
    height: int = 0  # ä¼°ç®—é«˜åº¦ï¼ˆåƒç´ ï¼‰
    can_break: bool = True  # æ˜¯å¦å¯ä»¥åœ¨æ­¤å¤„åˆ†é¡µ
    
class SmartPaginator:
    """æ™ºèƒ½åˆ†é¡µå™¨"""
    
    # å…ƒç´ é«˜åº¦ä¼°ç®—ï¼ˆåƒç´ ï¼‰- è°ƒæ•´ä¸ºæ›´å‡†ç¡®çš„å€¼
    ELEMENT_HEIGHTS = {
        'h1': 90,        # å¤§æ ‡é¢˜ + åº•éƒ¨è¾¹æ¡†
        'h2': 70,        # äºŒçº§æ ‡é¢˜
        'h3': 60,        # ä¸‰çº§æ ‡é¢˜
        'h4': 50,        # å››çº§æ ‡é¢˜
        'h5': 45,        # äº”çº§æ ‡é¢˜
        'h6': 40,        # å…­çº§æ ‡é¢˜
        'p_base': 25,    # æ®µè½åŸºç¡€é«˜åº¦
        'p_line': 28,    # æ®µè½æ¯è¡Œé«˜åº¦ï¼ˆè€ƒè™‘è¡Œé«˜1.8ï¼‰
        'li': 35,        # åˆ—è¡¨é¡¹
        'code_block': 40,  # ä»£ç å—åŸºç¡€é«˜åº¦
        'code_line': 24,   # ä»£ç æ¯è¡Œé«˜åº¦
        'blockquote': 60,  # å¼•ç”¨å—åŸºç¡€é«˜åº¦
        'blockquote_line': 28,  # å¼•ç”¨æ¯è¡Œé«˜åº¦
        'table_header': 45,  # è¡¨æ ¼å¤´
        'table_row': 40,     # è¡¨æ ¼è¡Œ
        'hr': 35,           # åˆ†éš”çº¿
        'margin_bottom': 20,  # å…ƒç´ åº•éƒ¨é—´è·
    }
    
    # é¡µé¢å‚æ•°
    PAGE_HEIGHT = 1440  # å°çº¢ä¹¦å¡ç‰‡é«˜åº¦
    PAGE_WIDTH = 1080   # å°çº¢ä¹¦å¡ç‰‡å®½åº¦
    PADDING_TOP = 45    # é¡¶éƒ¨å†…è¾¹è·
    PADDING_BOTTOM = 70 # åº•éƒ¨å†…è¾¹è·ï¼ˆåŒ…å«æ°´å°å’Œé¡µç åŒºåŸŸï¼‰
    PADDING_SIDES = 40  # å·¦å³å†…è¾¹è·
    
    # å†…å®¹åŒºåŸŸå®é™…å®½åº¦ï¼ˆç”¨äºè®¡ç®—æ–‡æœ¬æ¢è¡Œï¼‰
    CONTENT_WIDTH = PAGE_WIDTH - (PADDING_SIDES * 2)  # 1000px
    
    # æœ‰æ•ˆå†…å®¹é«˜åº¦
    CONTENT_HEIGHT = PAGE_HEIGHT - PADDING_TOP - PADDING_BOTTOM  # 1325px
    
    # åˆ†é¡µç­–ç•¥å‚æ•°
    MIN_ORPHAN_LINES = 2  # å­¤è¡Œæ§åˆ¶ï¼šæ®µè½æœ«å°¾æœ€å°‘ä¿ç•™è¡Œæ•°
    MIN_WIDOW_LINES = 2   # å¯¡è¡Œæ§åˆ¶ï¼šæ®µè½å¼€å¤´æœ€å°‘ä¿ç•™è¡Œæ•°
    HEADING_KEEP_WITH = 150  # æ ‡é¢˜åè‡³å°‘ä¿ç•™çš„å†…å®¹é«˜åº¦
    
    # å­—ç¬¦å®½åº¦ä¼°ç®—ï¼ˆåƒç´ ï¼‰
    CHAR_WIDTH = 16  # ä¸­æ–‡å­—ç¬¦å¹³å‡å®½åº¦
    CHAR_WIDTH_EN = 9  # è‹±æ–‡å­—ç¬¦å¹³å‡å®½åº¦
    
    def __init__(self):
        self.elements: List[PageElement] = []
        
    def parse_html_to_elements(self, html: str) -> List[PageElement]:
        """å°†HTMLè§£æä¸ºé¡µé¢å…ƒç´ åˆ—è¡¨ï¼Œä¿æŒåŸå§‹é¡ºåº"""
        elements = []
        
        # ä½¿ç”¨BeautifulSoupè§£æHTML
        soup = BeautifulSoup(html, 'html.parser')
        
        # éå†æ‰€æœ‰é¡¶å±‚å…ƒç´ 
        for element in soup.children:
            if isinstance(element, NavigableString):
                # å¤„ç†çº¯æ–‡æœ¬
                text = str(element).strip()
                if text:
                    elements.append(PageElement(
                        type='text',
                        content=f'<p>{text}</p>',
                        text=text,
                        height=self._calculate_text_height(text),
                        can_break=True
                    ))
            elif isinstance(element, Tag):
                # å¤„ç†HTMLæ ‡ç­¾
                parsed_element = self._parse_element(element)
                if parsed_element:
                    elements.append(parsed_element)
        
        return elements
    
    def _parse_element(self, element: Tag) -> Optional[PageElement]:
        """è§£æå•ä¸ªHTMLå…ƒç´ """
        tag_name = element.name.lower()
        
        # æ ‡é¢˜å…ƒç´ 
        if tag_name in ['h1', 'h2', 'h3', 'h4', 'h5', 'h6']:
            level = int(tag_name[1])
            text = element.get_text(strip=True)
            height = self.ELEMENT_HEIGHTS[tag_name] + self.ELEMENT_HEIGHTS['margin_bottom']
            
            return PageElement(
                type='heading',
                content=str(element),
                text=text,
                level=level,
                height=height,
                can_break=False  # æ ‡é¢˜å‰ä¸åˆ†é¡µ
            )
        
        # æ®µè½
        elif tag_name == 'p':
            text = element.get_text(strip=True)
            if not text:
                return None
                
            height = self._calculate_paragraph_height(text)
            
            return PageElement(
                type='paragraph',
                content=str(element),
                text=text,
                height=height,
                can_break=True
            )
        
        # åˆ—è¡¨
        elif tag_name in ['ul', 'ol']:
            items = element.find_all('li')
            text = element.get_text(strip=True)
            height = len(items) * self.ELEMENT_HEIGHTS['li'] + self.ELEMENT_HEIGHTS['margin_bottom']
            
            return PageElement(
                type='list',
                content=str(element),
                text=text,
                height=height,
                can_break=len(items) > 3  # åˆ—è¡¨é¡¹å¤šäº3ä¸ªæ—¶å¯ä»¥åˆ†é¡µ
            )
        
        # ä»£ç å—
        elif tag_name == 'pre':
            text = element.get_text()
            lines = text.count('\n') + 1
            height = (self.ELEMENT_HEIGHTS['code_block'] + 
                     lines * self.ELEMENT_HEIGHTS['code_line'] +
                     self.ELEMENT_HEIGHTS['margin_bottom'])
            
            return PageElement(
                type='code',
                content=str(element),
                text=text,
                height=height,
                can_break=lines > 10  # ä»£ç è¶…è¿‡10è¡Œå¯ä»¥è€ƒè™‘åˆ†é¡µ
            )
        
        # å¼•ç”¨
        elif tag_name == 'blockquote':
            text = element.get_text(strip=True)
            height = self._calculate_blockquote_height(text)
            
            return PageElement(
                type='blockquote',
                content=str(element),
                text=text,
                height=height,
                can_break=True
            )
        
        # è¡¨æ ¼
        elif tag_name == 'table':
            rows = element.find_all('tr')
            headers = element.find_all('th')
            text = element.get_text(strip=True)
            
            height = (len(headers) * self.ELEMENT_HEIGHTS['table_header'] +
                     (len(rows) - len(headers)) * self.ELEMENT_HEIGHTS['table_row'] +
                     self.ELEMENT_HEIGHTS['margin_bottom'])
            
            return PageElement(
                type='table',
                content=str(element),
                text=text,
                height=height,
                can_break=len(rows) > 5  # è¡¨æ ¼è¡Œæ•°å¤šäº5è¡Œæ—¶å¯ä»¥åˆ†é¡µ
            )
        
        # åˆ†éš”çº¿
        elif tag_name == 'hr':
            return PageElement(
                type='hr',
                content=str(element),
                text='',
                height=self.ELEMENT_HEIGHTS['hr'],
                can_break=True
            )
        
        # å…¶ä»–å—çº§å…ƒç´ 
        elif tag_name in ['div', 'section', 'article']:
            # é€’å½’å¤„ç†å­å…ƒç´ 
            sub_elements = []
            for child in element.children:
                if isinstance(child, Tag):
                    parsed = self._parse_element(child)
                    if parsed:
                        sub_elements.append(parsed)
            
            # å¦‚æœæœ‰å­å…ƒç´ ï¼Œè¿”å›ç¬¬ä¸€ä¸ªï¼ˆç®€åŒ–å¤„ç†ï¼‰
            if sub_elements:
                return sub_elements[0]
        
        return None
    
    def _calculate_text_height(self, text: str) -> int:
        """è®¡ç®—çº¯æ–‡æœ¬é«˜åº¦"""
        lines = self._estimate_lines(text)
        return self.ELEMENT_HEIGHTS['p_base'] + lines * self.ELEMENT_HEIGHTS['p_line']
    
    def _calculate_paragraph_height(self, text: str) -> int:
        """è®¡ç®—æ®µè½é«˜åº¦"""
        lines = self._estimate_lines(text)
        height = self.ELEMENT_HEIGHTS['p_base'] + lines * self.ELEMENT_HEIGHTS['p_line']
        return height + self.ELEMENT_HEIGHTS['margin_bottom']
    
    def _calculate_blockquote_height(self, text: str) -> int:
        """è®¡ç®—å¼•ç”¨å—é«˜åº¦"""
        lines = self._estimate_lines(text, width_reduction=100)  # å¼•ç”¨æœ‰ç¼©è¿›
        height = self.ELEMENT_HEIGHTS['blockquote'] + lines * self.ELEMENT_HEIGHTS['blockquote_line']
        return height + self.ELEMENT_HEIGHTS['margin_bottom']
    
    def _estimate_lines(self, text: str, width_reduction: int = 0) -> int:
        """ä¼°ç®—æ–‡æœ¬è¡Œæ•°"""
        if not text:
            return 1
        
        # è®¡ç®—å¯ç”¨å®½åº¦
        available_width = self.CONTENT_WIDTH - width_reduction
        
        # ç²—ç•¥ä¼°ç®—ï¼šä¸­è‹±æ–‡æ··åˆ
        # ç»Ÿè®¡ä¸­æ–‡å­—ç¬¦æ•°
        chinese_chars = len(re.findall(r'[\u4e00-\u9fa5]', text))
        english_chars = len(text) - chinese_chars
        
        # è®¡ç®—æ€»å®½åº¦
        total_width = (chinese_chars * self.CHAR_WIDTH + 
                      english_chars * self.CHAR_WIDTH_EN)
        
        # è®¡ç®—è¡Œæ•°
        lines = max(1, int(total_width / available_width) + 1)
        
        # è€ƒè™‘å¼ºåˆ¶æ¢è¡Œ
        forced_breaks = text.count('\n')
        
        return lines + forced_breaks
    
    def paginate(self, html_content: str) -> List[str]:
        """æ‰§è¡Œæ™ºèƒ½åˆ†é¡µ"""
        # å¦‚æœå†…å®¹å¾ˆçŸ­ï¼Œç›´æ¥è¿”å›
        if not html_content or len(html_content.strip()) < 100:
            return [html_content] if html_content else ['<p>æ— å†…å®¹</p>']
        
        # è§£æHTMLä¸ºå…ƒç´ 
        elements = self.parse_html_to_elements(html_content)
        if not elements:
            return [html_content]
        
        pages = []
        current_page_elements = []
        current_height = 0
        
        for i, element in enumerate(elements):
            # æ£€æŸ¥æ˜¯å¦éœ€è¦æ–°é¡µé¢
            need_new_page = False
            
            # 1. åŸºç¡€é«˜åº¦æ£€æŸ¥
            if current_height + element.height > self.CONTENT_HEIGHT:
                need_new_page = True
            
            # 2. æ ‡é¢˜å…³è”æ£€æŸ¥ï¼ˆé¿å…æ ‡é¢˜å­¤ç«‹ï¼‰
            if element.type == 'heading':
                # æ£€æŸ¥æ ‡é¢˜åæ˜¯å¦æœ‰è¶³å¤Ÿç©ºé—´æ”¾ç½®å†…å®¹
                remaining_height = self.CONTENT_HEIGHT - current_height - element.height
                
                if remaining_height < self.HEADING_KEEP_WITH:
                    # å‰©ä½™ç©ºé—´ä¸è¶³ï¼Œå°†æ ‡é¢˜ç§»åˆ°ä¸‹ä¸€é¡µ
                    need_new_page = True
                
                # å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ä¸”ä¸æ˜¯ç¬¬ä¸€é¡µï¼Œä¸è¦åˆ†é¡µ
                if not current_page_elements and pages:
                    need_new_page = False
            
            # 3. æ®µè½å®Œæ•´æ€§æ£€æŸ¥
            if element.type == 'paragraph' and current_page_elements:
                # å¦‚æœæ®µè½å¤ªå¤§ï¼Œä¸”å½“å‰é¡µå·²æœ‰å†…å®¹ï¼Œè€ƒè™‘åˆ†é¡µ
                if element.height > self.CONTENT_HEIGHT * 0.6 and current_height > self.CONTENT_HEIGHT * 0.3:
                    need_new_page = True
            
            # 4. é¿å…é¡µé¢è¿‡ç©º
            if need_new_page and current_height < self.CONTENT_HEIGHT * 0.3:
                # å¦‚æœå½“å‰é¡µé¢å¡«å……ä¸åˆ°30%ï¼Œå°½é‡ä¸åˆ†é¡µ
                if element.can_break or element.height < self.CONTENT_HEIGHT * 0.5:
                    need_new_page = False
            
            # åˆ›å»ºæ–°é¡µé¢
            if need_new_page and current_page_elements:
                page_html = ''.join([e.content for e in current_page_elements])
                pages.append(page_html)
                current_page_elements = []
                current_height = 0
            
            # æ·»åŠ å…ƒç´ åˆ°å½“å‰é¡µ
            current_page_elements.append(element)
            current_height += element.height
        
        # æ·»åŠ æœ€åä¸€é¡µ
        if current_page_elements:
            page_html = ''.join([e.content for e in current_page_elements])
            pages.append(page_html)
        
        # ä¼˜åŒ–åˆ†é¡µç»“æœ
        pages = self.optimize_pages(pages)
        
        return pages if pages else [html_content]
    
    def optimize_pages(self, pages: List[str]) -> List[str]:
        """ä¼˜åŒ–åˆ†é¡µç»“æœï¼Œåˆå¹¶è¿‡çŸ­çš„é¡µé¢"""
        if len(pages) <= 1:
            return pages
        
        optimized = []
        i = 0
        
        while i < len(pages):
            current_page = pages[i]
            
            # ä¼°ç®—å½“å‰é¡µé¢é«˜åº¦
            current_elements = self.parse_html_to_elements(current_page)
            current_height = sum(e.height for e in current_elements)
            
            # å¦‚æœé¡µé¢è¿‡çŸ­ï¼Œå°è¯•ä¸ä¸‹ä¸€é¡µåˆå¹¶
            if current_height < self.CONTENT_HEIGHT * 0.4 and i < len(pages) - 1:
                next_page = pages[i + 1]
                next_elements = self.parse_html_to_elements(next_page)
                next_height = sum(e.height for e in next_elements)
                
                # å¦‚æœåˆå¹¶åä¸è¶…è¿‡æœ€å¤§é«˜åº¦ï¼Œåˆ™åˆå¹¶
                if current_height + next_height <= self.CONTENT_HEIGHT:
                    optimized.append(current_page + next_page)
                    i += 2  # è·³è¿‡ä¸‹ä¸€é¡µ
                    continue
            
            optimized.append(current_page)
            i += 1
        
        return optimized if optimized else pages
    
    def debug_pagination(self, html_content: str) -> List[dict]:
        """è°ƒè¯•åˆ†é¡µï¼Œè¿”å›è¯¦ç»†ä¿¡æ¯"""
        elements = self.parse_html_to_elements(html_content)
        pages_info = []
        
        pages = self.paginate(html_content)
        for i, page in enumerate(pages, 1):
            page_elements = self.parse_html_to_elements(page)
            total_height = sum(e.height for e in page_elements)
            
            pages_info.append({
                'page_num': i,
                'elements_count': len(page_elements),
                'total_height': total_height,
                'max_height': self.CONTENT_HEIGHT,
                'fill_rate': f"{(total_height / self.CONTENT_HEIGHT * 100):.1f}%",
                'elements': [
                    {
                        'type': e.type,
                        'height': e.height,
                        'text_preview': e.text[:50] + '...' if len(e.text) > 50 else e.text
                    }
                    for e in page_elements
                ]
            })
        
        return pages_info style_manager.py->text/plain-># ============================================
# src/utils/style_manager.py
# ============================================
from typing import Dict, Any
from dataclasses import dataclass

@dataclass
class ThemeConfig:
    """ä¸»é¢˜é…ç½®"""
    name: str
    primary_color: str
    secondary_color: str
    text_color: str
    background: str
    font_family: str
    heading_font: str
    code_font: str
    
class StyleManager:
    """æ ·å¼ç®¡ç†å™¨"""
    
    # é¢„è®¾ä¸»é¢˜
    THEMES = {
        "xiaohongshu": ThemeConfig(
            name="å°çº¢ä¹¦",
            primary_color="#FF2442",
            secondary_color="#FF6B6B",
            text_color="#2c3e50",
            background="linear-gradient(135deg, #ffeef8 0%, #ffe0f0 100%)",
            font_family='-apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", "Microsoft YaHei", sans-serif',
            heading_font='"PingFang SC", "Helvetica Neue", sans-serif',
            code_font='"JetBrains Mono", "Cascadia Code", "Consolas", monospace'
        ),
        "instagram": ThemeConfig(
            name="Instagram",
            primary_color="#E4405F",
            secondary_color="#BC2A8D",
            text_color="#262626",
            background="linear-gradient(45deg, #F9ED69 0%, #EE2A7B 50%, #6228D7 100%)",
            font_family='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',
            heading_font='"Segoe UI", Roboto, sans-serif',
            code_font='"Monaco", "Courier New", monospace'
        ),
        "wechat": ThemeConfig(
            name="å¾®ä¿¡",
            primary_color="#07C160",
            secondary_color="#4CAF50",
            text_color="#353535",
            background="linear-gradient(180deg, #F7F7F7 0%, #FFFFFF 100%)",
            font_family='"PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif',
            heading_font='"PingFang SC", "Microsoft YaHei", sans-serif',
            code_font='"SF Mono", "Monaco", "Inconsolata", monospace'
        ),
        "zhihu": ThemeConfig(
            name="çŸ¥ä¹",
            primary_color="#0084FF",
            secondary_color="#1890FF",
            text_color="#1A1A1A",
            background="linear-gradient(180deg, #FFFFFF 0%, #F6F6F6 100%)",
            font_family='"PingFang SC", "Helvetica Neue", "Microsoft YaHei", sans-serif',
            heading_font='"PingFang SC", "Helvetica Neue", sans-serif',
            code_font='"Source Code Pro", "Consolas", monospace'
        ),
        "dark": ThemeConfig(
            name="æ·±è‰²æ¨¡å¼",
            primary_color="#00E0FF",
            secondary_color="#0096FF",
            text_color="#E0E6ED",
            background="linear-gradient(135deg, #0F0F1E 0%, #1A1A2E 50%, #16213E 100%)",
            font_family='"Inter", "PingFang SC", "Microsoft YaHei", sans-serif',
            heading_font='"Inter", "PingFang SC", sans-serif',
            code_font='"Fira Code", "JetBrains Mono", monospace'
        )
    }
    
    def __init__(self, theme: str = "xiaohongshu"):
        self.current_theme = theme
        self.custom_styles = {}
        
    def get_theme(self, theme_name: str = None) -> ThemeConfig:
        """è·å–ä¸»é¢˜é…ç½®"""
        if theme_name is None:
            theme_name = self.current_theme
        return self.THEMES.get(theme_name, self.THEMES["xiaohongshu"])
    
    def set_theme(self, theme_name: str):
        """è®¾ç½®å½“å‰ä¸»é¢˜"""
        if theme_name in self.THEMES:
            self.current_theme = theme_name
    
    def generate_css(self, theme_name: str = None) -> str:
        """ç”Ÿæˆä¸»é¢˜CSS"""
        theme = self.get_theme(theme_name)
        
        return f"""
        /* ä¸»é¢˜: {theme.name} */
        :root {{
            --primary-color: {theme.primary_color};
            --secondary-color: {theme.secondary_color};
            --text-color: {theme.text_color};
            --font-family: {theme.font_family};
            --heading-font: {theme.heading_font};
            --code-font: {theme.code_font};
        }}
        
        body {{
            font-family: var(--font-family);
            background: {theme.background};
            color: var(--text-color);
        }}
        
        h1, h2, h3, h4, h5, h6 {{
            font-family: var(--heading-font);
            color: var(--primary-color);
        }}
        
        h1 {{
            border-bottom-color: {self._lighten_color(theme.primary_color, 0.7)};
        }}
        
        h2::before {{
            background: linear-gradient(180deg, {theme.primary_color}, {theme.secondary_color});
        }}
        
        strong {{
            color: var(--primary-color);
            background: linear-gradient(180deg, transparent 70%, {self._lighten_color(theme.primary_color, 0.8)} 70%);
        }}
        
        ul li::marker, ol li::marker {{
            color: var(--primary-color);
        }}
        
        blockquote {{
            border-left-color: var(--primary-color);
            background: linear-gradient(90deg, {self._lighten_color(theme.primary_color, 0.95)} 0%, #FFFFFF 100%);
        }}
        
        code {{
            font-family: var(--code-font);
            background: {self._lighten_color(theme.primary_color, 0.95)};
            color: {self._darken_color(theme.primary_color, 0.2)};
        }}
        
        pre {{
            font-family: var(--code-font);
        }}
        
        th {{
            background: linear-gradient(135deg, {theme.primary_color}, {theme.secondary_color});
        }}
        
        a {{
            color: var(--primary-color);
            border-bottom-color: {self._lighten_color(theme.primary_color, 0.5)};
        }}
        
        a:hover {{
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            background: {self._lighten_color(theme.primary_color, 0.95)};
        }}
        
        ::-webkit-scrollbar-thumb {{
            background: linear-gradient(180deg, {theme.secondary_color}, {theme.primary_color});
        }}
        
        ::-webkit-scrollbar-thumb:hover {{
            background: linear-gradient(180deg, {theme.primary_color}, {self._darken_color(theme.primary_color, 0.2)});
        }}
        """
    
    def _lighten_color(self, color: str, amount: float) -> str:
        """ä½¿é¢œè‰²å˜æµ…"""
        # ç®€åŒ–å®ç°ï¼Œå®é™…åº”è¯¥è¿›è¡ŒRGBè®¡ç®—
        if amount >= 0.9:
            return f"{color}10"  # æ·»åŠ é€æ˜åº¦
        elif amount >= 0.7:
            return f"{color}30"
        else:
            return f"{color}50"
    
    def _darken_color(self, color: str, amount: float) -> str:
        """ä½¿é¢œè‰²å˜æ·±"""
        # ç®€åŒ–å®ç°
        return color
    
    def get_export_settings(self, theme_name: str = None) -> Dict[str, Any]:
        """è·å–å¯¼å‡ºè®¾ç½®"""
        theme = self.get_theme(theme_name)
        
        return {
            "page_width": 1080,
            "page_height": 1440,
            "padding": {
                "top": 45,
                "bottom": 45,
                "left": 40,
                "right": 40
            },
            "font_size": 16,
            "line_height": 1.8,
            "paragraph_spacing": 20,
            "image_quality": 100,
            "format": "PNG"
        }
    
    def apply_custom_styles(self, styles: Dict[str, str]):
        """åº”ç”¨è‡ªå®šä¹‰æ ·å¼"""
        self.custom_styles.update(styles)
    
    def get_combined_css(self, theme_name: str = None) -> str:
        """è·å–ç»„åˆçš„CSSï¼ˆä¸»é¢˜ + è‡ªå®šä¹‰ï¼‰"""
        base_css = self.generate_css(theme_name)
        
        if self.custom_styles:
            custom_css = "\n/* è‡ªå®šä¹‰æ ·å¼ */\n"
            for selector, rules in self.custom_styles.items():
                custom_css += f"{selector} {{\n{rules}\n}}\n"
            return base_css + custom_css
        
        return base_css
### ç³»ç»Ÿ:
æˆ‘æ¥åˆ†æä½ çš„éœ€æ±‚å¹¶åˆ¶å®šå®æ–½è®¡åˆ’ï¼š

## éœ€æ±‚åˆ†æ

1. **ä¸‰ç§å°ºå¯¸**ï¼ˆä¿æŒ3:4æ¯”ä¾‹ï¼Œå­—ä½“ä¸å˜ï¼‰ï¼š
   - å°å°ºå¯¸ï¼š720Ã—960pxï¼ˆå†…å®¹å°‘ï¼Œé€‚åˆç®€çŸ­åˆ†äº«ï¼‰
   - ä¸­å°ºå¯¸ï¼š1080Ã—1440pxï¼ˆå½“å‰é»˜è®¤ï¼‰  
   - å¤§å°ºå¯¸ï¼š1440Ã—1920pxï¼ˆå†…å®¹å¤šï¼Œé€‚åˆé•¿æ–‡ï¼‰

2. **å¤šç§é…è‰²é£æ ¼**ï¼šæ‰©å±•ç°æœ‰çš„5ç§ä¸»é¢˜

## å®æ–½æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šæ·»åŠ å°ºå¯¸é€‰æ‹©åŠŸèƒ½ âœ… ï¼ˆæœ¬æ¬¡å®Œæˆï¼‰
### ç¬¬äºŒæ­¥ï¼šæ‰©å±•é…è‰²ä¸»é¢˜
### ç¬¬ä¸‰æ­¥ï¼šä¼˜åŒ–UIäº¤äº’

## ç¬¬ä¸€æ­¥å®ç°æ–¹æ¡ˆ

éœ€è¦ä¿®æ”¹4ä¸ªæ–‡ä»¶ï¼Œæˆ‘æŒ‰ä¿®æ”¹é‡ä»å°åˆ°å¤§è¯´æ˜ï¼š

### 1. **html_generator.py** - ä¿®æ”¹è¾ƒå°
åœ¨ `__init__` æ–¹æ³•ä¸­æ·»åŠ å°ºå¯¸å‚æ•°ï¼š
```python
# ç¬¬7è¡Œé™„è¿‘ï¼Œä¿®æ”¹åˆå§‹åŒ–æ–¹æ³•
def __init__(self, font_size: int = 18, page_size: str = "medium"):
    self.resource_path = Path(__file__).parent.parent / "resources"
    self.base_font_size = font_size
    
    # æ·»åŠ é¡µé¢å°ºå¯¸é…ç½®
    self.page_sizes = {
        "small": {"width": 720, "height": 960},
        "medium": {"width": 1080, "height": 1440},
        "large": {"width": 1440, "height": 1920}
    }
    self.current_size = page_size
    self.page_width = self.page_sizes[page_size]["width"]
    self.page_height = self.page_sizes[page_size]["height"]
```

åœ¨ `get_css` æ–¹æ³•ä¸­ä½¿ç”¨åŠ¨æ€å°ºå¯¸ï¼ˆç¬¬45è¡Œé™„è¿‘ï¼‰ï¼š
```python
# å°†å›ºå®šçš„ 1080px å’Œ 1440px æ›¿æ¢ä¸ºåŠ¨æ€å€¼
html, body {{
    width: {self.page_width}px;
    height: {self.page_height}px;
    overflow: hidden !important;
}}

.container {{
    width: {self.page_width}px;
    height: {self.page_height}px;
    position: relative;
}}
```

### 2. **exporter.py** - ä¿®æ”¹è¾ƒå°
ç¬¬89è¡Œé™„è¿‘ï¼Œä½¿ç”¨åŠ¨æ€å°ºå¯¸ï¼š
```python
def _capture_fixed_size(self, output_path: Path, page_num: int):
    """æ•è·å›ºå®šå°ºå¯¸çš„é¡µé¢"""
    try:
        # ä»html_generatorè·å–å½“å‰å°ºå¯¸
        target_width = self.html_generator.page_width
        target_height = self.html_generator.page_height
```

### 3. **paginator.py** - ä¿®æ”¹è¾ƒå¤§ï¼Œéœ€è¦å®Œæ•´ä»£ç  ä»£ç 
```python
# ============================================
# src/utils/paginator.py
# ============================================
from typing import List, Tuple, Optional, Dict
from dataclasses import dataclass
from bs4 import BeautifulSoup, NavigableString, Tag
import re

@dataclass
class PageElement:
    """é¡µé¢å…ƒç´ """
    type: str  # 'heading', 'paragraph', 'list', 'code', 'blockquote', 'table', 'hr', 'text'
    content: str  # HTMLå†…å®¹
    text: str  # çº¯æ–‡æœ¬å†…å®¹ï¼ˆç”¨äºè®¡ç®—é«˜åº¦ï¼‰
    level: int = 0  # æ ‡é¢˜çº§åˆ«æˆ–åµŒå¥—æ·±åº¦
    height: int = 0  # ä¼°ç®—é«˜åº¦ï¼ˆåƒç´ ï¼‰
    can_break: bool = True  # æ˜¯å¦å¯ä»¥åœ¨æ­¤å¤„åˆ†é¡µ
    
class SmartPaginator:
    """æ™ºèƒ½åˆ†é¡µå™¨ - æ”¯æŒå¤šå°ºå¯¸"""
    
    # å…ƒç´ é«˜åº¦ä¼°ç®—ï¼ˆåƒç´ ï¼‰- è°ƒæ•´ä¸ºæ›´å‡†ç¡®çš„å€¼
    ELEMENT_HEIGHTS = {
        'h1': 90,        # å¤§æ ‡é¢˜ + åº•éƒ¨è¾¹æ¡†
        'h2': 70,        # äºŒçº§æ ‡é¢˜
        'h3': 60,        # ä¸‰çº§æ ‡é¢˜
        'h4': 50,        # å››çº§æ ‡é¢˜
        'h5': 45,        # äº”çº§æ ‡é¢˜
        'h6': 40,        # å…­çº§æ ‡é¢˜
        'p_base': 25,    # æ®µè½åŸºç¡€é«˜åº¦
        'p_line': 28,    # æ®µè½æ¯è¡Œé«˜åº¦ï¼ˆè€ƒè™‘è¡Œé«˜1.8ï¼‰
        'li': 35,        # åˆ—è¡¨é¡¹
        'code_block': 40,  # ä»£ç å—åŸºç¡€é«˜åº¦
        'code_line': 24,   # ä»£ç æ¯è¡Œé«˜åº¦
        'blockquote': 60,  # å¼•ç”¨å—åŸºç¡€é«˜åº¦
        'blockquote_line': 28,  # å¼•ç”¨æ¯è¡Œé«˜åº¦
        'table_header': 45,  # è¡¨æ ¼å¤´
        'table_row': 40,     # è¡¨æ ¼è¡Œ
        'hr': 35,           # åˆ†éš”çº¿
        'margin_bottom': 20,  # å…ƒç´ åº•éƒ¨é—´è·
    }
    
    # é¡µé¢å°ºå¯¸é…ç½®
    PAGE_SIZES = {
        "small": {
            "width": 720,
            "height": 960,
            "padding_top": 35,
            "padding_bottom": 50,
            "padding_sides": 30
        },
        "medium": {
            "width": 1080,
            "height": 1440,
            "padding_top": 45,
            "padding_bottom": 70,
            "padding_sides": 40
        },
        "large": {
            "width": 1440,
            "height": 1920,
            "padding_top": 55,
            "padding_bottom": 90,
            "padding_sides": 50
        }
    }
    
    # åˆ†é¡µç­–ç•¥å‚æ•°
    MIN_ORPHAN_LINES = 2  # å­¤è¡Œæ§åˆ¶ï¼šæ®µè½æœ«å°¾æœ€å°‘ä¿ç•™è¡Œæ•°
    MIN_WIDOW_LINES = 2   # å¯¡è¡Œæ§åˆ¶ï¼šæ®µè½å¼€å¤´æœ€å°‘ä¿ç•™è¡Œæ•°
    HEADING_KEEP_WITH = 150  # æ ‡é¢˜åè‡³å°‘ä¿ç•™çš„å†…å®¹é«˜åº¦
    
    # å­—ç¬¦å®½åº¦ä¼°ç®—ï¼ˆåƒç´ ï¼‰
    CHAR_WIDTH = 16  # ä¸­æ–‡å­—ç¬¦å¹³å‡å®½åº¦
    CHAR_WIDTH_EN = 9  # è‹±æ–‡å­—ç¬¦å¹³å‡å®½åº¦
    
    def __init__(self, page_size: str = "medium"):
        """
        åˆå§‹åŒ–åˆ†é¡µå™¨
        
        Args:
            page_size: é¡µé¢å°ºå¯¸ ("small", "medium", "large")
        """
        self.elements: List[PageElement] = []
        self.set_page_size(page_size)
        
    def set_page_size(self, size: str):
        """è®¾ç½®é¡µé¢å°ºå¯¸"""
        if size not in self.PAGE_SIZES:
            size = "medium"
        
        config = self.PAGE_SIZES[size]
        self.page_size_name = size
        self.page_width = config["width"]
        self.page_height = config["height"]
        self.padding_top = config["padding_top"]
        self.padding_bottom = config["padding_bottom"]
        self.padding_sides = config["padding_sides"]
        
        # è®¡ç®—å†…å®¹åŒºåŸŸ
        self.content_width = self.page_width - (self.padding_sides * 2)
        self.content_height = self.page_height - self.padding_top - self.padding_bottom
        
        # æ ¹æ®å°ºå¯¸è°ƒæ•´åˆ†é¡µç­–ç•¥
        if size == "small":
            self.HEADING_KEEP_WITH = 100  # å°å°ºå¯¸é¡µé¢ï¼Œæ ‡é¢˜åä¿ç•™ç©ºé—´å¯ä»¥æ›´å°‘
        elif size == "large":
            self.HEADING_KEEP_WITH = 200  # å¤§å°ºå¯¸é¡µé¢ï¼Œæ ‡é¢˜åä¿ç•™æ›´å¤šç©ºé—´
        else:
            self.HEADING_KEEP_WITH = 150
    
    def get_page_info(self) -> Dict:
        """è·å–å½“å‰é¡µé¢é…ç½®ä¿¡æ¯"""
        return {
            "size_name": self.page_size_name,
            "width": self.page_width,
            "height": self.page_height,
            "content_width": self.content_width,
            "content_height": self.content_height,
            "padding": {
                "top": self.padding_top,
                "bottom": self.padding_bottom,
                "sides": self.padding_sides
            }
        }
        
    def parse_html_to_elements(self, html: str) -> List[PageElement]:
        """å°†HTMLè§£æä¸ºé¡µé¢å…ƒç´ åˆ—è¡¨ï¼Œä¿æŒåŸå§‹é¡ºåº"""
        elements = []
        
        # ä½¿ç”¨BeautifulSoupè§£æHTML
        soup = BeautifulSoup(html, 'html.parser')
        
        # éå†æ‰€æœ‰é¡¶å±‚å…ƒç´ 
        for element in soup.children:
            if isinstance(element, NavigableString):
                # å¤„ç†çº¯æ–‡æœ¬
                text = str(element).strip()
                if text:
                    elements.append(PageElement(
                        type='text',
                        content=f'<p>{text}</p>',
                        text=text,
                        height=self._calculate_text_height(text),
                        can_break=True
                    ))
            elif isinstance(element, Tag):
                # å¤„ç†HTMLæ ‡ç­¾
                parsed_element = self._parse_element(element)
                if parsed_element:
                    elements.append(parsed_element)
        
        return elements
    
    def _parse_element(self, element: Tag) -> Optional[PageElement]:
        """è§£æå•ä¸ªHTMLå…ƒç´ """
        tag_name = element.name.lower()
        
        # æ ‡é¢˜å…ƒç´ 
        if tag_name in ['h1', 'h2', 'h3', 'h4', 'h5', 'h6']:
            level = int(tag_name[1])
            text = element.get_text(strip=True)
            height = self.ELEMENT_HEIGHTS[tag_name] + self.ELEMENT_HEIGHTS['margin_bottom']
            
            return PageElement(
                type='heading',
                content=str(element),
                text=text,
                level=level,
                height=height,
                can_break=False  # æ ‡é¢˜å‰ä¸åˆ†é¡µ
            )
        
        # æ®µè½
        elif tag_name == 'p':
            text = element.get_text(strip=True)
            if not text:
                return None
                
            height = self._calculate_paragraph_height(text)
            
            return PageElement(
                type='paragraph',
                content=str(element),
                text=text,
                height=height,
                can_break=True
            )
        
        # åˆ—è¡¨
        elif tag_name in ['ul', 'ol']:
            items = element.find_all('li')
            text = element.get_text(strip=True)
            height = len(items) * self.ELEMENT_HEIGHTS['li'] + self.ELEMENT_HEIGHTS['margin_bottom']
            
            return PageElement(
                type='list',
                content=str(element),
                text=text,
                height=height,
                can_break=len(items) > 3  # åˆ—è¡¨é¡¹å¤šäº3ä¸ªæ—¶å¯ä»¥åˆ†é¡µ
            )
        
        # ä»£ç å—
        elif tag_name == 'pre':
            text = element.get_text()
            lines = text.count('\n') + 1
            height = (self.ELEMENT_HEIGHTS['code_block'] + 
                     lines * self.ELEMENT_HEIGHTS['code_line'] +
                     self.ELEMENT_HEIGHTS['margin_bottom'])
            
            return PageElement(
                type='code',
                content=str(element),
                text=text,
                height=height,
                can_break=lines > 10  # ä»£ç è¶…è¿‡10è¡Œå¯ä»¥è€ƒè™‘åˆ†é¡µ
            )
        
        # å¼•ç”¨
        elif tag_name == 'blockquote':
            text = element.get_text(strip=True)
            height = self._calculate_blockquote_height(text)
            
            return PageElement(
                type='blockquote',
                content=str(element),
                text=text,
                height=height,
                can_break=True
            )
        
        # è¡¨æ ¼
        elif tag_name == 'table':
            rows = element.find_all('tr')
            headers = element.find_all('th')
            text = element.get_text(strip=True)
            
            height = (len(headers) * self.ELEMENT_HEIGHTS['table_header'] +
                     (len(rows) - len(headers)) * self.ELEMENT_HEIGHTS['table_row'] +
                     self.ELEMENT_HEIGHTS['margin_bottom'])
            
            return PageElement(
                type='table',
                content=str(element),
                text=text,
                height=height,
                can_break=len(rows) > 5  # è¡¨æ ¼è¡Œæ•°å¤šäº5è¡Œæ—¶å¯ä»¥åˆ†é¡µ
            )
        
        # åˆ†éš”çº¿
        elif tag_name == 'hr':
            return PageElement(
                type='hr',
                content=str(element),
                text='',
                height=self.ELEMENT_HEIGHTS['hr'],
                can_break=True
            )
        
        # å…¶ä»–å—çº§å…ƒç´ 
        elif tag_name in ['div', 'section', 'article']:
            # é€’å½’å¤„ç†å­å…ƒç´ 
            sub_elements = []
            for child in element.children:
                if isinstance(child, Tag):
                    parsed = self._parse_element(child)
                    if parsed:
                        sub_elements.append(parsed)
            
            # å¦‚æœæœ‰å­å…ƒç´ ï¼Œè¿”å›ç¬¬ä¸€ä¸ªï¼ˆç®€åŒ–å¤„ç†ï¼‰
            if sub_elements:
                return sub_elements[0]
        
        return None
    
    def _calculate_text_height(self, text: str) -> int:
        """è®¡ç®—çº¯æ–‡æœ¬é«˜åº¦"""
        lines = self._estimate_lines(text)
        return self.ELEMENT_HEIGHTS['p_base'] + lines * self.ELEMENT_HEIGHTS['p_line']
    
    def _calculate_paragraph_height(self, text: str) -> int:
        """è®¡ç®—æ®µè½é«˜åº¦"""
        lines = self._estimate_lines(text)
        height = self.ELEMENT_HEIGHTS['p_base'] + lines * self.ELEMENT_HEIGHTS['p_line']
        return height + self.ELEMENT_HEIGHTS['margin_bottom']
    
    def _calculate_blockquote_height(self, text: str) -> int:
        """è®¡ç®—å¼•ç”¨å—é«˜åº¦"""
        lines = self._estimate_lines(text, width_reduction=100)  # å¼•ç”¨æœ‰ç¼©è¿›
        height = self.ELEMENT_HEIGHTS['blockquote'] + lines * self.ELEMENT_HEIGHTS['blockquote_line']
        return height + self.ELEMENT_HEIGHTS['margin_bottom']
    
    def _estimate_lines(self, text: str, width_reduction: int = 0) -> int:
        """ä¼°ç®—æ–‡æœ¬è¡Œæ•° - æ ¹æ®é¡µé¢å®½åº¦åŠ¨æ€è®¡ç®—"""
        if not text:
            return 1
        
        # è®¡ç®—å¯ç”¨å®½åº¦ï¼ˆä½¿ç”¨åŠ¨æ€å†…å®¹å®½åº¦ï¼‰
        available_width = self.content_width - width_reduction
        
        # ç²—ç•¥ä¼°ç®—ï¼šä¸­è‹±æ–‡æ··åˆ
        # ç»Ÿè®¡ä¸­æ–‡å­—ç¬¦æ•°
        chinese_chars = len(re.findall(r'[\u4e00-\u9fa5]', text))
        english_chars = len(text) - chinese_chars
        
        # è®¡ç®—æ€»å®½åº¦
        total_width = (chinese_chars * self.CHAR_WIDTH + 
                      english_chars * self.CHAR_WIDTH_EN)
        
        # è®¡ç®—è¡Œæ•°
        lines = max(1, int(total_width / available_width) + 1)
        
        # è€ƒè™‘å¼ºåˆ¶æ¢è¡Œ
        forced_breaks = text.count('\n')
        
        return lines + forced_breaks
    
    def paginate(self, html_content: str) -> List[str]:
        """æ‰§è¡Œæ™ºèƒ½åˆ†é¡µ"""
        # å¦‚æœå†…å®¹å¾ˆçŸ­ï¼Œç›´æ¥è¿”å›
        if not html_content or len(html_content.strip()) < 100:
            return [html_content] if html_content else ['<p>æ— å†…å®¹</p>']
        
        # è§£æHTMLä¸ºå…ƒç´ 
        elements = self.parse_html_to_elements(html_content)
        if not elements:
            return [html_content]
        
        pages = []
        current_page_elements = []
        current_height = 0
        
        for i, element in enumerate(elements):
            # æ£€æŸ¥æ˜¯å¦éœ€è¦æ–°é¡µé¢
            need_new_page = False
            
            # 1. åŸºç¡€é«˜åº¦æ£€æŸ¥ï¼ˆä½¿ç”¨åŠ¨æ€å†…å®¹é«˜åº¦ï¼‰
            if current_height + element.height > self.content_height:
                need_new_page = True
            
            # 2. æ ‡é¢˜å…³è”æ£€æŸ¥ï¼ˆé¿å…æ ‡é¢˜å­¤ç«‹ï¼‰
            if element.type == 'heading':
                # æ£€æŸ¥æ ‡é¢˜åæ˜¯å¦æœ‰è¶³å¤Ÿç©ºé—´æ”¾ç½®å†…å®¹
                remaining_height = self.content_height - current_height - element.height
                
                if remaining_height < self.HEADING_KEEP_WITH:
                    # å‰©ä½™ç©ºé—´ä¸è¶³ï¼Œå°†æ ‡é¢˜ç§»åˆ°ä¸‹ä¸€é¡µ
                    need_new_page = True
                
                # å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ä¸”ä¸æ˜¯ç¬¬ä¸€é¡µï¼Œä¸è¦åˆ†é¡µ
                if not current_page_elements and pages:
                    need_new_page = False
            
            # 3. æ®µè½å®Œæ•´æ€§æ£€æŸ¥
            if element.type == 'paragraph' and current_page_elements:
                # å¦‚æœæ®µè½å¤ªå¤§ï¼Œä¸”å½“å‰é¡µå·²æœ‰å†…å®¹ï¼Œè€ƒè™‘åˆ†é¡µ
                if element.height > self.content_height * 0.6 and current_height > self.content_height * 0.3:
                    need_new_page = True
            
            # 4. é¿å…é¡µé¢è¿‡ç©ºï¼ˆæ ¹æ®é¡µé¢å°ºå¯¸è°ƒæ•´é˜ˆå€¼ï¼‰
            min_fill_ratio = 0.25 if self.page_size_name == "small" else 0.3
            if need_new_page and current_height < self.content_height * min_fill_ratio:
                # å¦‚æœå½“å‰é¡µé¢å¡«å……ä¸è¶³ï¼Œå°½é‡ä¸åˆ†é¡µ
                if element.can_break or element.height < self.content_height * 0.5:
                    need_new_page = False
            
            # åˆ›å»ºæ–°é¡µé¢
            if need_new_page and current_page_elements:
                page_html = ''.join([e.content for e in current_page_elements])
                pages.append(page_html)
                current_page_elements = []
                current_height = 0
            
            # æ·»åŠ å…ƒç´ åˆ°å½“å‰é¡µ
            current_page_elements.append(element)
            current_height += element.height
        
        # æ·»åŠ æœ€åä¸€é¡µ
        if current_page_elements:
            page_html = ''.join([e.content for e in current_page_elements])
            pages.append(page_html)
        
        # ä¼˜åŒ–åˆ†é¡µç»“æœ
        pages = self.optimize_pages(pages)
        
        return pages if pages else [html_content]
    
    def optimize_pages(self, pages: List[str]) -> List[str]:
        """ä¼˜åŒ–åˆ†é¡µç»“æœï¼Œåˆå¹¶è¿‡çŸ­çš„é¡µé¢"""
        if len(pages) <= 1:
            return pages
        
        optimized = []
        i = 0
        
        # æ ¹æ®é¡µé¢å°ºå¯¸è°ƒæ•´åˆå¹¶é˜ˆå€¼
        merge_threshold = 0.35 if self.page_size_name == "small" else 0.4
        
        while i < len(pages):
            current_page = pages[i]
            
            # ä¼°ç®—å½“å‰é¡µé¢é«˜åº¦
            current_elements = self.parse_html_to_elements(current_page)
            current_height = sum(e.height for e in current_elements)
            
            # å¦‚æœé¡µé¢è¿‡çŸ­ï¼Œå°è¯•ä¸ä¸‹ä¸€é¡µåˆå¹¶
            if current_height < self.content_height * merge_threshold and i < len(pages) - 1:
                next_page = pages[i + 1]
                next_elements = self.parse_html_to_elements(next_page)
                next_height = sum(e.height for e in next_elements)
                
                # å¦‚æœåˆå¹¶åä¸è¶…è¿‡æœ€å¤§é«˜åº¦ï¼Œåˆ™åˆå¹¶
                if current_height + next_height <= self.content_height:
                    optimized.append(current_page + next_page)
                    i += 2  # è·³è¿‡ä¸‹ä¸€é¡µ
                    continue
            
            optimized.append(current_page)
            i += 1
        
        return optimized if optimized else pages
    
    def debug_pagination(self, html_content: str) -> List[dict]:
        """è°ƒè¯•åˆ†é¡µï¼Œè¿”å›è¯¦ç»†ä¿¡æ¯"""
        elements = self.parse_html_to_elements(html_content)
        pages_info = []
        
        pages = self.paginate(html_content)
        for i, page in enumerate(pages, 1):
            page_elements = self.parse_html_to_elements(page)
            total_height = sum(e.height for e in page_elements)
            
            pages_info.append({
                'page_num': i,
                'page_size': self.page_size_name,
                'content_dimensions': f"{self.content_width}Ã—{self.content_height}px",
                'elements_count': len(page_elements),
                'total_height': total_height,
                'max_height': self.content_height,
                'fill_rate': f"{(total_height / self.content_height * 100):.1f}%",
                'elements': [
                    {
                        'type': e.type,
                        'height': e.height,
                        'text_preview': e.text[:50] + '...' if len(e.text) > 50 else e.text
                    }
                    for e in page_elements
                ]
            })
        
        return pages_info
```
 ### 4. **preview_widget.py** - ä¿®æ”¹è¾ƒå¤§ï¼Œéœ€è¦å®Œæ•´ä»£ç  ä»£ç 
```python
# ============================================
# src/ui/preview_widget.py
# ============================================
from PySide6.QtWidgets import (QWidget, QVBoxLayout, QLabel, QFrame, 
                               QPushButton, QHBoxLayout, QProgressDialog,
                               QMessageBox, QScrollArea, QSlider, QComboBox)
from PySide6.QtWebEngineWidgets import QWebEngineView
from PySide6.QtCore import QUrl, QTimer, Signal, Qt, QSize
from pathlib import Path
from src.core.markdown_processor import MarkdownProcessor
from src.core.html_generator import HTMLGenerator
from src.utils.paginator import SmartPaginator
from src.utils.exporter import ImageExporter

class PreviewWidget(QWidget):
    pageChanged = Signal(int, int)  # å½“å‰é¡µï¼Œæ€»é¡µæ•°
    sizeChanged = Signal(str)  # å°ºå¯¸æ”¹å˜ä¿¡å·
    
    def __init__(self):
        super().__init__()
        self.current_pages = []  # å­˜å‚¨åˆ†é¡µåçš„HTMLå†…å®¹
        self.current_page = 1
        self.total_pages = 1
        self.markdown_text = ""  # ä¿å­˜åŸå§‹markdownæ–‡æœ¬
        self.current_zoom = 1.0  # å½“å‰ç¼©æ”¾æ¯”ä¾‹
        self.current_size = "medium"  # å½“å‰é¡µé¢å°ºå¯¸
        self.init_ui()
        self.setup_exporter()
        
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        layout.setContentsMargins(0, 0, 0, 0)
        layout.setSpacing(0)
        
        # åˆ›å»ºå®¹å™¨æ¡†æ¶
        container = QFrame()
        container.setStyleSheet("""
            QFrame {
                background: rgba(25, 25, 40, 0.95);
                border: 1px solid rgba(0, 224, 255, 0.2);
                border-radius: 16px;
            }
        """)
        container_layout = QVBoxLayout(container)
        container_layout.setContentsMargins(0, 0, 0, 0)
        container_layout.setSpacing(0)
        
        # æ ‡é¢˜æ 
        title_bar = QFrame()
        title_bar.setFixedHeight(50)
        title_bar.setStyleSheet("""
            QFrame {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.1),
                    stop: 0.5 rgba(0, 150, 255, 0.15),
                    stop: 1 rgba(0, 224, 255, 0.1)
                );
                border-top-left-radius: 16px;
                border-top-right-radius: 16px;
                border-bottom: 1px solid rgba(0, 224, 255, 0.2);
                padding: 12px 20px;
            }
        """)
        title_layout = QHBoxLayout(title_bar)
        
        title = QLabel("ğŸ‘€ å®æ—¶é¢„è§ˆ")
        title.setStyleSheet("""
            QLabel {
                color: #00e0ff;
                font-size: 16px;
                font-weight: 600;
                letter-spacing: 0.5px;
            }
        """)
        
        # å°ºå¯¸é€‰æ‹©ä¸‹æ‹‰æ¡†
        self.size_selector = QComboBox()
        self.size_selector.addItems(["å°å°ºå¯¸ (720Ã—960)", "ä¸­å°ºå¯¸ (1080Ã—1440)", "å¤§å°ºå¯¸ (1440Ã—1920)"])
        self.size_selector.setCurrentIndex(1)  # é»˜è®¤ä¸­å°ºå¯¸
        self.size_selector.setFixedWidth(150)
        self.size_selector.setStyleSheet("""
            QComboBox {
                background: rgba(0, 224, 255, 0.1);
                border: 1px solid rgba(0, 224, 255, 0.3);
                color: #00e0ff;
                padding: 5px 10px;
                border-radius: 6px;
                font-size: 12px;
                font-weight: 500;
            }
            QComboBox:hover {
                background: rgba(0, 224, 255, 0.15);
                border: 1px solid rgba(0, 224, 255, 0.5);
            }
            QComboBox::drop-down {
                border: none;
                width: 20px;
            }
            QComboBox::down-arrow {
                image: none;
                border-left: 4px solid transparent;
                border-right: 4px solid transparent;
                border-top: 5px solid #00e0ff;
                margin-right: 5px;
            }
            QComboBox QAbstractItemView {
                background: rgba(25, 25, 40, 0.98);
                border: 1px solid rgba(0, 224, 255, 0.3);
                color: #00e0ff;
                selection-background-color: rgba(0, 224, 255, 0.2);
                outline: none;
            }
        """)
        
        # é¡µé¢ä¿¡æ¯æ ‡ç­¾
        self.page_info_label = QLabel("")
        self.page_info_label.setStyleSheet("""
            QLabel {
                color: #8a92a6;
                font-size: 12px;
                padding: 0 10px;
            }
        """)
        
        # ç¼©æ”¾æ˜¾ç¤ºæ ‡ç­¾
        self.zoom_label = QLabel("100%")
        self.zoom_label.setStyleSheet("""
            QLabel {
                color: #8a92a6;
                font-size: 12px;
                padding: 0 10px;
            }
        """)
        
        title_layout.addWidget(title)
        title_layout.addWidget(QLabel("å°ºå¯¸:", styleSheet="color: #8a92a6; font-size: 12px;"))
        title_layout.addWidget(self.size_selector)
        title_layout.addWidget(self.page_info_label)
        title_layout.addStretch()
        title_layout.addWidget(self.zoom_label)
        
        # åˆ›å»ºæ»šåŠ¨åŒºåŸŸæ¥åŒ…å« WebView
        self.scroll_area = QScrollArea()
        self.scroll_area.setStyleSheet("""
            QScrollArea {
                border: none;
                background: #2a2a3e;
            }
            QScrollBar:vertical {
                background: rgba(20, 20, 35, 0.5);
                width: 12px;
                border-radius: 6px;
                margin: 5px;
            }
            QScrollBar::handle:vertical {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.4),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
                border-radius: 6px;
                min-height: 30px;
            }
            QScrollBar::handle:vertical:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.6),
                    stop: 1 rgba(0, 150, 255, 0.5)
                );
            }
            QScrollBar::add-line:vertical,
            QScrollBar::sub-line:vertical {
                border: none;
                background: none;
                height: 0;
            }
            QScrollBar:horizontal {
                background: rgba(20, 20, 35, 0.5);
                height: 12px;
                border-radius: 6px;
                margin: 5px;
            }
            QScrollBar::handle:horizontal {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.4),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
                border-radius: 6px;
                min-width: 30px;
            }
            QScrollBar::handle:horizontal:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 rgba(0, 224, 255, 0.6),
                    stop: 1 rgba(0, 150, 255, 0.5)
                );
            }
            QScrollBar::add-line:horizontal,
            QScrollBar::sub-line:horizontal {
                border: none;
                background: none;
                width: 0;
            }
        """)
        
        # Webè§†å›¾ - åŠ¨æ€å°ºå¯¸
        self.web_view = QWebEngineView()
        self.update_web_view_size()
        self.web_view.setStyleSheet("""
            QWebEngineView {
                border: none;
                background: white;
            }
        """)
        
        # ç¦ç”¨ WebView çš„æ»šåŠ¨æ¡
        self.web_view.page().settings().setAttribute(
            self.web_view.page().settings().WebAttribute.ShowScrollBars, False
        )
        
        # è®¾ç½®æ»šåŠ¨åŒºåŸŸ
        self.scroll_area.setWidget(self.web_view)
        self.scroll_area.setWidgetResizable(False)  # ä¸è‡ªåŠ¨è°ƒæ•´å¤§å°
        self.scroll_area.setHorizontalScrollBarPolicy(Qt.ScrollBarAsNeeded)
        self.scroll_area.setVerticalScrollBarPolicy(Qt.ScrollBarAsNeeded)
        self.scroll_area.setAlignment(Qt.AlignCenter)  # å±…ä¸­æ˜¾ç¤º
        
        # ç¿»é¡µæ§åˆ¶æ 
        control_bar = QFrame()
        control_bar.setFixedHeight(60)
        control_bar.setStyleSheet("""
            QFrame {
                background: rgba(20, 20, 35, 0.8);
                padding: 10px 20px;
                border-bottom-left-radius: 16px;
                border-bottom-right-radius: 16px;
                border-top: 1px solid rgba(0, 224, 255, 0.1);
            }
        """)
        control_layout = QHBoxLayout(control_bar)
        
        self.prev_btn = QPushButton("â¬… ä¸Šä¸€é¡µ")
        self.prev_btn.setFixedSize(100, 36)
        self.prev_btn.setStyleSheet(self.get_button_style())
        
        self.next_btn = QPushButton("ä¸‹ä¸€é¡µ â¡")
        self.next_btn.setFixedSize(100, 36)
        self.next_btn.setStyleSheet(self.get_button_style())
        
        # ç¼©æ”¾æ»‘å—
        self.zoom_slider = QSlider(Qt.Horizontal)
        self.zoom_slider.setRange(25, 150)  # 25% - 150%
        self.zoom_slider.setValue(100)  # é»˜è®¤100%
        self.zoom_slider.setFixedWidth(200)
        self.zoom_slider.setStyleSheet("""
            QSlider::groove:horizontal {
                height: 6px;
                background: rgba(0, 224, 255, 0.2);
                border-radius: 3px;
            }
            QSlider::handle:horizontal {
                width: 18px;
                height: 18px;
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 #00e0ff,
                    stop: 1 #0096ff
                );
                border-radius: 9px;
                margin: -6px 0;
            }
            QSlider::handle:horizontal:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 #00f0ff,
                    stop: 1 #00a6ff
                );
            }
        """)
        
        # ç¼©æ”¾æŒ‰é’®
        self.zoom_fit_btn = QPushButton("ğŸ” é€‚åº”çª—å£")
        self.zoom_fit_btn.setFixedSize(100, 36)
        self.zoom_fit_btn.setStyleSheet(self.get_button_style())
        
        self.zoom_100_btn = QPushButton("ğŸ“ 100%")
        self.zoom_100_btn.setFixedSize(80, 36)
        self.zoom_100_btn.setStyleSheet(self.get_button_style())
        
        control_layout.addWidget(self.prev_btn)
        control_layout.addSpacing(20)
        control_layout.addWidget(QLabel("ç¼©æ”¾:", styleSheet="color: #8a92a6;"))
        control_layout.addWidget(self.zoom_slider)
        control_layout.addWidget(self.zoom_100_btn)
        control_layout.addWidget(self.zoom_fit_btn)
        control_layout.addStretch()
        control_layout.addWidget(self.next_btn)
        
        # ç»„è£…å¸ƒå±€
        container_layout.addWidget(title_bar)
        container_layout.addWidget(self.scroll_area, 1)
        container_layout.addWidget(control_bar)
        
        layout.addWidget(container)
        
        # å¤„ç†å™¨ - åˆå§‹åŒ–æ—¶ä½¿ç”¨é»˜è®¤å°ºå¯¸
        self.markdown_processor = MarkdownProcessor()
        self.html_generator = HTMLGenerator(page_size="medium")
        self.paginator = SmartPaginator(page_size="medium")
        
        # è¿æ¥ä¿¡å·
        self.prev_btn.clicked.connect(self.prev_page)
        self.next_btn.clicked.connect(self.next_page)
        self.zoom_slider.valueChanged.connect(self.on_zoom_changed)
        self.zoom_fit_btn.clicked.connect(self.zoom_to_fit)
        self.zoom_100_btn.clicked.connect(self.zoom_to_100)
        self.size_selector.currentIndexChanged.connect(self.on_size_changed)
        
        # åˆå§‹åŒ–æŒ‰é’®çŠ¶æ€
        self.update_buttons()
        
        # å»¶è¿Ÿè‡ªé€‚åº”ï¼ˆç­‰å¾…çª—å£å®Œå…¨åŠ è½½ï¼‰
        QTimer.singleShot(500, self.zoom_to_fit)
    
    def get_button_style(self) -> str:
        """è·å–æŒ‰é’®æ ·å¼"""
        return """
            QPushButton {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.15),
                    stop: 1 rgba(0, 150, 255, 0.1)
                );
                border: 1px solid rgba(0, 224, 255, 0.4);
                color: #00e0ff;
                padding: 8px 16px;
                border-radius: 8px;
                font-weight: 600;
                font-size: 13px;
            }
            QPushButton:hover {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.25),
                    stop: 1 rgba(0, 150, 255, 0.2)
                );
                border: 1px solid rgba(0, 224, 255, 0.6);
            }
            QPushButton:pressed {
                background: qlineargradient(
                    x1: 0, y1: 0, x2: 0, y2: 1,
                    stop: 0 rgba(0, 224, 255, 0.35),
                    stop: 1 rgba(0, 150, 255, 0.3)
                );
            }
            QPushButton:disabled {
                background: rgba(30, 30, 45, 0.5);
                border-color: rgba(100, 100, 120, 0.3);
                color: rgba(100, 100, 120, 0.5);
            }
        """
    
    def on_size_changed(self, index):
        """å¤„ç†å°ºå¯¸æ”¹å˜"""
        size_map = {0: "small", 1: "medium", 2: "large"}
        new_size = size_map.get(index, "medium")
        
        if new_size != self.current_size:
            self.current_size = new_size
            
            # æ›´æ–°å„ç»„ä»¶çš„å°ºå¯¸è®¾ç½®
            self.html_generator = HTMLGenerator(page_size=new_size)
            self.paginator.set_page_size(new_size)
            
            # æ›´æ–°WebViewå°ºå¯¸
            self.update_web_view_size()
            
            # é‡æ–°å¤„ç†å†…å®¹
            if self.markdown_text:
                self.update_content(self.markdown_text)
            
            # å‘é€å°ºå¯¸æ”¹å˜ä¿¡å·
            self.sizeChanged.emit(new_size)
            
            # å»¶è¿Ÿåè‡ªé€‚åº”ç¼©æ”¾
            QTimer.singleShot(100, self.zoom_to_fit)
    
    def update_web_view_size(self):
        """æ›´æ–°WebViewå°ºå¯¸"""
        size_config = {
            "small": (720, 960),
            "medium": (1080, 1440),
            "large": (1440, 1920)
        }
        width, height = size_config.get(self.current_size, (1080, 1440))
        self.web_view.setFixedSize(width, height)
    
    def on_zoom_changed(self, value):
        """å¤„ç†ç¼©æ”¾æ»‘å—å˜åŒ–"""
        zoom = value / 100.0
        self.set_zoom(zoom)
    
    def set_zoom(self, zoom_factor):
        """è®¾ç½®ç¼©æ”¾æ¯”ä¾‹"""
        self.current_zoom = zoom_factor
        self.web_view.setZoomFactor(zoom_factor)
        self.zoom_label.setText(f"{int(zoom_factor * 100)}%")
        
        # ä¸éœ€è¦æ”¹å˜æ»‘å—å€¼æ—¶çš„ä¿¡å·é˜»å¡
        self.zoom_slider.blockSignals(True)
        self.zoom_slider.setValue(int(zoom_factor * 100))
        self.zoom_slider.blockSignals(False)
    
    def zoom_to_fit(self):
        """ç¼©æ”¾åˆ°é€‚åº”çª—å£"""
        if self.scroll_area and self.web_view:
            # è·å–æ»šåŠ¨åŒºåŸŸçš„å¯è§†å¤§å°
            viewport_size = self.scroll_area.viewport().size()
            
            # è·å–å½“å‰é¡µé¢å°ºå¯¸
            card_width = self.web_view.width()
            card_height = self.web_view.height()
            
            # è®¡ç®—ç¼©æ”¾æ¯”ä¾‹ï¼ˆç•™å‡ºä¸€äº›è¾¹è·ï¼‰
            margin = 20
            scale_x = (viewport_size.width() - margin * 2) / card_width
            scale_y = (viewport_size.height() - margin * 2) / card_height
            scale = min(scale_x, scale_y, 1.0)  # ä¸è¶…è¿‡100%
            
            # åº”ç”¨ç¼©æ”¾
            self.set_zoom(scale)
    
    def zoom_to_100(self):
        """æ¢å¤100%å¤§å°"""
        self.set_zoom(1.0)
    
    def setup_exporter(self):
        """è®¾ç½®å¯¼å‡ºå™¨"""
        self.exporter = ImageExporter(self.web_view)
        self.exporter.progress.connect(self.on_export_progress)
        self.exporter.finished.connect(self.on_export_finished)
        self.exporter.page_exported.connect(self.on_page_exported)
        
    def update_content(self, markdown_text: str):
        """æ›´æ–°é¢„è§ˆå†…å®¹"""
        try:
            self.markdown_text = markdown_text
            
            # å¤„ç† Markdown
            html_content = self.markdown_processor.parse(markdown_text)
            
            # ä½¿ç”¨æ™ºèƒ½åˆ†é¡µå™¨è¿›è¡Œåˆ†é¡µ
            self.current_pages = self.paginator.paginate(html_content)
            
            # ä¼˜åŒ–åˆ†é¡µç»“æœ
            self.current_pages = self.paginator.optimize_pages(self.current_pages)
            
            self.total_pages = len(self.current_pages)
            self.current_page = 1
            
            # æ˜¾ç¤ºç¬¬ä¸€é¡µ
            self.display_current_page()
            
            # æ›´æ–°æŒ‰é’®
            self.update_buttons()
            
            # æ›´æ–°é¡µé¢ä¿¡æ¯
            self.update_page_info()
            
            # ä¿æŒå½“å‰ç¼©æ”¾æ¯”ä¾‹
            QTimer.singleShot(100, lambda: self.set_zoom(self.current_zoom))
            
        except Exception as e:
            self.show_error(f"é¢„è§ˆé”™è¯¯: {str(e)}")
    
    def update_page_info(self):
        """æ›´æ–°é¡µé¢ä¿¡æ¯æ˜¾ç¤º"""
        if self.total_pages > 1:
            self.page_info_label.setText(f"ç¬¬ {self.current_page}/{self.total_pages} é¡µ")
        else:
            self.page_info_label.setText("")
    
    def display_current_page(self):
        """æ˜¾ç¤ºå½“å‰é¡µ"""
        if not self.current_pages:
            return
            
        if 1 <= self.current_page <= len(self.current_pages):
            page_content = self.current_pages[self.current_page - 1]
            
            # ç”Ÿæˆå®Œæ•´HTML
            full_html = self.html_generator.generate(page_content)
            
            # åŠ è½½åˆ°WebView
            self.web_view.setHtml(full_html, QUrl("file:///"))
    
    def prev_page(self):
        """ä¸Šä¸€é¡µ"""
        if self.current_page > 1:
            self.current_page -= 1
            self.display_current_page()
            self.update_buttons()
            self.update_page_info()
    
    def next_page(self):
        """ä¸‹ä¸€é¡µ"""
        if self.current_page < self.total_pages:
            self.current_page += 1
            self.display_current_page()
            self.update_buttons()
            self.update_page_info()
    
    def update_buttons(self):
        """æ›´æ–°æŒ‰é’®çŠ¶æ€"""
        self.prev_btn.setEnabled(self.current_page > 1)
        self.next_btn.setEnabled(self.current_page < self.total_pages)
        
        # å‘é€é¡µé¢æ”¹å˜ä¿¡å·
        self.pageChanged.emit(self.current_page, self.total_pages)
    
    def export_pages(self, folder: str):
        """å¯¼å‡ºæ‰€æœ‰é¡µé¢ä¸ºå›¾ç‰‡"""
        if not self.current_pages:
            QMessageBox.warning(self, "æç¤º", "æ²¡æœ‰å¯å¯¼å‡ºçš„å†…å®¹")
            return
        
        # åˆ›å»ºè¿›åº¦å¯¹è¯æ¡†
        self.progress_dialog = QProgressDialog(
            "æ­£åœ¨å¯¼å‡ºå›¾ç‰‡...", 
            "å–æ¶ˆ", 
            0, 
            self.total_pages, 
            self
        )
        self.progress_dialog.setWindowModality(Qt.WindowModal)
        self.progress_dialog.setMinimumDuration(0)
        self.progress_dialog.canceled.connect(self.on_export_canceled)
        
        # å¯¼å‡ºå‰æ¢å¤100%å¤§å°ï¼ˆç¡®ä¿å¯¼å‡ºçš„æ˜¯åŸå§‹å°ºå¯¸ï¼‰
        original_zoom = self.current_zoom
        self.web_view.setZoomFactor(1.0)
        
        # å¼€å§‹å¯¼å‡º
        self.exporter.export_pages(
            self.current_pages,
            folder,
            self.html_generator,
            format="PNG",
            quality=100
        )
        
        # ä¿å­˜åŸå§‹ç¼©æ”¾æ¯”ä¾‹ï¼Œå¯¼å‡ºå®Œæˆåæ¢å¤
        self._original_zoom_for_export = original_zoom
    
    def on_export_progress(self, current: int, total: int):
        """å¤„ç†å¯¼å‡ºè¿›åº¦"""
        if hasattr(self, 'progress_dialog'):
            self.progress_dialog.setValue(current)
            self.progress_dialog.setLabelText(f"æ­£åœ¨å¯¼å‡ºç¬¬ {current}/{total} é¡µ...")
    
    def on_export_finished(self, success: bool, message: str):
        """å¤„ç†å¯¼å‡ºå®Œæˆ"""
        # å…³é—­è¿›åº¦å¯¹è¯æ¡†
        if hasattr(self, 'progress_dialog') and self.progress_dialog is not None:
            try:
                self.progress_dialog.close()
                self.progress_dialog.deleteLater()
            except:
                pass
            finally:
                self.progress_dialog = None
        
        # æ¢å¤åŸå§‹ç¼©æ”¾æ¯”ä¾‹
        if hasattr(self, '_original_zoom_for_export'):
            self.set_zoom(self._original_zoom_for_export)
            delattr(self, '_original_zoom_for_export')
        
        if success:
            # æ·»åŠ å°ºå¯¸ä¿¡æ¯åˆ°æ¶ˆæ¯ä¸­
            size_info = f"({self.current_size}: {self.web_view.width()}Ã—{self.web_view.height()}px)"
            QMessageBox.information(self, "å¯¼å‡ºæˆåŠŸ", f"{message}\nå°ºå¯¸: {size_info}")
        else:
            QMessageBox.warning(self, "å¯¼å‡ºå¤±è´¥", message)
    
    def on_page_exported(self, page_num: int, file_path: str):
        """å¤„ç†å•é¡µå¯¼å‡ºå®Œæˆ"""
        print(f"å·²å¯¼å‡ºç¬¬ {page_num} é¡µ: {file_path}")
    
    def on_export_canceled(self):
        """å¤„ç†å¯¼å‡ºå–æ¶ˆ"""
        self.exporter.cancel_export()
        # æ¢å¤åŸå§‹ç¼©æ”¾
        if hasattr(self, '_original_zoom_for_export'):
            self.set_zoom(self._original_zoom_for_export)
            delattr(self, '_original_zoom_for_export')
    
    def handle_scroll(self, percentage: float):
        """å¤„ç†ç¼–è¾‘å™¨æ»šåŠ¨åŒæ­¥"""
        # å›ºå®šå°ºå¯¸ï¼Œä¸éœ€è¦æ»šåŠ¨åŒæ­¥
        pass
    
    def show_error(self, message: str):
        """æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯"""
        error_html = f"""
        <html>
        <body style="padding: 20px; font-family: sans-serif; background: #1a1a2e; color: #e0e6ed;">
            <h3 style="color: #ff4757;">é”™è¯¯</h3>
            <p style="color: #8a92a6;">{message}</p>
        </body>
        </html>
        """
        self.web_view.setHtml(error_html)
```
 ## å®æ–½æ€»ç»“

### ä¿®æ”¹æ¸…å•

#### 1. **html_generator.py** ï¼ˆå°ä¿®æ”¹ï¼‰
- **ç¬¬7è¡Œ**ï¼šä¿®æ”¹ `__init__` æ–¹æ³•ï¼Œæ·»åŠ  `page_size` å‚æ•°å’Œå°ºå¯¸é…ç½®
- **ç¬¬45-60è¡Œ**ï¼šåœ¨ `get_css()` ä¸­å°†å›ºå®šçš„ `1080px/1440px` æ›¿æ¢ä¸º `{self.page_width}px/{self.page_height}px`

#### 2. **exporter.py** ï¼ˆå°ä¿®æ”¹ï¼‰  
- **ç¬¬89è¡Œ** `_capture_fixed_size` æ–¹æ³•ï¼š
```python
# æ›¿æ¢å›ºå®šå€¼
target_width = self.html_generator.page_width
target_height = self.html_generator.page_height
```

#### 3. **paginator.py** ï¼ˆå¤§ä¿®æ”¹ï¼‰
- ä½¿ç”¨ä¸Šé¢æä¾›çš„å®Œæ•´ä»£ç æ›¿æ¢åŸæ–‡ä»¶
- ä¸»è¦æ”¹åŠ¨ï¼š
  - æ·»åŠ äº† `PAGE_SIZES` é…ç½®å­—å…¸
  - æ–°å¢ `set_page_size()` æ–¹æ³•
  - æ‰€æœ‰é«˜åº¦è®¡ç®—æ”¹ä¸ºåŠ¨æ€å€¼

#### 4. **preview_widget.py** ï¼ˆå¤§ä¿®æ”¹ï¼‰
- ä½¿ç”¨ä¸Šé¢æä¾›çš„å®Œæ•´ä»£ç æ›¿æ¢åŸæ–‡ä»¶
- ä¸»è¦æ”¹åŠ¨ï¼š
  - æ·»åŠ å°ºå¯¸é€‰æ‹©ä¸‹æ‹‰æ¡†
  - æ–°å¢ `on_size_changed()` æ–¹æ³•
  - æ›´æ–° WebView å°ºå¯¸åŠ¨æ€è°ƒæ•´

## æµ‹è¯•è¦ç‚¹

1. **å°ºå¯¸åˆ‡æ¢**ï¼šç¡®ä¿ä¸‰ç§å°ºå¯¸åˆ‡æ¢æµç•…
2. **å†…å®¹é€‚é…**ï¼šéªŒè¯ä¸åŒå°ºå¯¸ä¸‹åˆ†é¡µæ•ˆæœ
3. **å¯¼å‡ºåŠŸèƒ½**ï¼šç¡®è®¤å¯¼å‡ºçš„å›¾ç‰‡å°ºå¯¸æ­£ç¡®
4. **ç¼©æ”¾åŠŸèƒ½**ï¼šæµ‹è¯•"é€‚åº”çª—å£"æŒ‰é’®

## ä¸‹ä¸€æ­¥è®¡åˆ’

å®Œæˆç¬¬ä¸€æ­¥åï¼Œç¬¬äºŒæ­¥å°†ï¼š
1. æ‰©å±• `style_manager.py` æ·»åŠ æ›´å¤šé…è‰²ä¸»é¢˜
2. åœ¨å·¥å…·æ æ·»åŠ ä¸»é¢˜é€‰æ‹©å™¨
3. å®ç°ä¸»é¢˜åˆ‡æ¢çš„å®æ—¶é¢„è§ˆ

éœ€è¦æˆ‘ç»§ç»­ç¬¬äºŒæ­¥çš„å®ç°å—ï¼Ÿ
### ç”¨æˆ·:
ç»§ç»­
### ç³»ç»Ÿ:
## ç¬¬äºŒæ­¥ï¼šæ‰©å±•é…è‰²ä¸»é¢˜ç³»ç»Ÿ

### å®æ–½æ–¹æ¡ˆ

æˆ‘å°†æ·»åŠ æ›´å¤šé…è‰²ä¸»é¢˜ï¼Œå¹¶åœ¨å·¥å…·æ æ·»åŠ ä¸»é¢˜é€‰æ‹©å™¨ï¼Œå®ç°å®æ—¶åˆ‡æ¢é¢„è§ˆã€‚

### 1. **style_manager.py** - å®Œæ•´æ›´æ–°ç‰ˆæœ¬ï¼ˆæ‰©å±•ä¸»é¢˜ï¼‰ ä»£ç 
```python
# ============================================
# src/utils/style_manager.py
# ============================================
from typing import Dict, Any, Tuple
from dataclasses import dataclass
import colorsys

@dataclass
class ThemeConfig:
    """ä¸»é¢˜é…ç½®"""
    name: str
    primary_color: str
    secondary_color: str
    text_color: str
    background: str
    font_family: str
    heading_font: str
    code_font: str
    accent_color: str = ""  # å¼ºè°ƒè‰²
    link_color: str = ""    # é“¾æ¥è‰²
    
class StyleManager:
    """æ ·å¼ç®¡ç†å™¨ - æ‰©å±•ç‰ˆ"""
    
    # é¢„è®¾ä¸»é¢˜ - 12ç§é£æ ¼
    THEMES = {
        # ç¤¾äº¤åª’ä½“é£æ ¼
        "xiaohongshu": ThemeConfig(
            name="å°çº¢ä¹¦ç»å…¸",
            primary_color="#FF2442",
            secondary_color="#FF6B6B",
            text_color="#2c3e50",
            background="linear-gradient(135deg, #ffeef8 0%, #ffe0f0 100%)",
            font_family='-apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", "Microsoft YaHei", sans-serif',
            heading_font='"PingFang SC", "Helvetica Neue", sans-serif',
            code_font='"JetBrains Mono", "Cascadia Code", "Consolas", monospace',
            accent_color="#FFB6C1",
            link_color="#FF69B4"
        ),
        
        "instagram": ThemeConfig(
            name="Instagramæ¸å˜",
            primary_color="#E4405F",
            secondary_color="#BC2A8D",
            text_color="#262626",
            background="linear-gradient(45deg, #F9ED69 0%, #EE2A7B 50%, #6228D7 100%)",
            font_family='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',
            heading_font='"Segoe UI", Roboto, sans-serif',
            code_font='"Monaco", "Courier New", monospace',
            accent_color="#FCAF45",
            link_color="#833AB4"
        ),
        
        "wechat": ThemeConfig(
            name="å¾®ä¿¡ç®€çº¦",
            primary_color="#07C160",
            secondary_color="#4CAF50",
            text_color="#353535",
            background="linear-gradient(180deg, #F7F7F7 0%, #FFFFFF 100%)",
            font_family='"PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif',
            heading_font='"PingFang SC", "Microsoft YaHei", sans-serif',
            code_font='"SF Mono", "Monaco", "Inconsolata", monospace',
            accent_color="#95EC69",
            link_color="#576B95"
        ),
        
        "douyin": ThemeConfig(
            name="æŠ–éŸ³é…·é»‘",
            primary_color="#FE2C55",
            secondary_color="#25F4EE",
            text_color="#FFFFFF",
            background="linear-gradient(135deg, #000000 0%, #161823 100%)",
            font_family='"PingFang SC", "Helvetica Neue", Arial, sans-serif',
            heading_font='"PingFang SC", "Helvetica Neue", sans-serif',
            code_font='"Fira Code", "Source Code Pro", monospace',
            accent_color="#00F2EA",
            link_color="#FE2C55"
        ),
        
        # çŸ¥è¯†å¹³å°é£æ ¼
        "zhihu": ThemeConfig(
            name="çŸ¥ä¹è“",
            primary_color="#0084FF",
            secondary_color="#1890FF",
            text_color="#1A1A1A",
            background="linear-gradient(180deg, #FFFFFF 0%, #F6F6F6 100%)",
            font_family='"PingFang SC", "Helvetica Neue", "Microsoft YaHei", sans-serif',
            heading_font='"PingFang SC", "Helvetica Neue", sans-serif',
            code_font='"Source Code Pro", "Consolas", monospace',
            accent_color="#5BBCFF",
            link_color="#175199"
        ),
        
        "notion": ThemeConfig(
            name="Notionæç®€",
            primary_color="#000000",
            secondary_color="#2F3437",
            text_color="#37352F",
            background="linear-gradient(180deg, #FFFFFF 0%, #FAFAFA 100%)",
            font_family='"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',
            heading_font='"Inter", -apple-system, sans-serif',
            code_font='"SFMono-Regular", "Consolas", "Liberation Mono", monospace',
            accent_color="#EB5757",
            link_color="#0070F3"
        ),
        
        # ä¼˜é›…é£æ ¼
        "elegant_purple": ThemeConfig(
            name="ä¼˜é›…ç´«",
            primary_color="#6B46C1",
            secondary_color="#9333EA",
            text_color="#1F2937",
            background="linear-gradient(135deg, #F9FAFB 0%, #F3E8FF 100%)",
            font_family='"Inter", "PingFang SC", "Microsoft YaHei", sans-serif',
            heading_font='"Playfair Display", "PingFang SC", serif',
            code_font='"JetBrains Mono", "Cascadia Code", monospace',
            accent_color="#A78BFA",
            link_color="#7C3AED"
        ),
        
        "ocean_blue": ThemeConfig(
            name="æµ·æ´‹è“",
            primary_color="#0EA5E9",
            secondary_color="#06B6D4",
            text_color="#0F172A",
            background="linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 50%, #BAE6FD 100%)",
            font_family='"Inter", "PingFang SC", "Microsoft YaHei", sans-serif',
            heading_font='"Inter", "PingFang SC", sans-serif',
            code_font='"Fira Code", "Consolas", monospace',
            accent_color="#38BDF8",
            link_color="#0284C7"
        ),
        
        "sunset_orange": ThemeConfig(
            name="æ—¥è½æ©™",
            primary_color="#F97316",
            secondary_color="#FB923C",
            text_color="#1C1917",
            background="linear-gradient(135deg, #FFF7ED 0%, #FED7AA 50%, #FDBA74 100%)",
            font_family='"Inter", "PingFang SC", "Microsoft YaHei", sans-serif',
            heading_font='"Inter", "PingFang SC", sans-serif',
            code_font='"Source Code Pro", "Monaco", monospace',
            accent_color="#FCD34D",
            link_color="#EA580C"
        ),
        
        "forest_green": ThemeConfig(
            name="æ£®æ—ç»¿",
            primary_color="#059669",
            secondary_color="#10B981",
            text_color="#064E3B",
            background="linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 50%, #A7F3D0 100%)",
            font_family='"Inter", "PingFang SC", "Microsoft YaHei", sans-serif',
            heading_font='"Inter", "PingFang SC", sans-serif',
            code_font='"JetBrains Mono", monospace',
            accent_color="#34D399",
            link_color="#047857"
        ),
        
        # æ·±è‰²ä¸»é¢˜
        "dark_mode": ThemeConfig(
            name="æ·±è‰²æ¨¡å¼",
            primary_color="#00E0FF",
            secondary_color="#0096FF",
            text_color="#E0E6ED",
            background="linear-gradient(135deg, #0F0F1E 0%, #1A1A2E 50%, #16213E 100%)",
            font_family='"Inter", "PingFang SC", "Microsoft YaHei", sans-serif',
            heading_font='"Inter", "PingFang SC", sans-serif',
            code_font='"Fira Code", "JetBrains Mono", monospace',
            accent_color="#00F0FF",
            link_color="#00B8D4"
        ),
        
        "midnight": ThemeConfig(
            name="åˆå¤œç´«",
            primary_color="#B794F4",
            secondary_color="#9F7AEA",
            text_color="#E9D8FD",
            background="linear-gradient(135deg, #1A202C 0%, #2D3748 50%, #4A5568 100%)",
            font_family='"Inter", "PingFang SC", "Microsoft YaHei", sans-serif',
            heading_font='"Inter", "PingFang SC", sans-serif',
            code_font='"Cascadia Code", "Fira Code", monospace',
            accent_color="#D6BCFA",
            link_color="#B794F4"
        )
    }
    
    def __init__(self, theme: str = "xiaohongshu"):
        self.current_theme = theme
        self.custom_styles = {}
        
    def get_theme(self, theme_name: str = None) -> ThemeConfig:
        """è·å–ä¸»é¢˜é…ç½®"""
        if theme_name is None:
            theme_name = self.current_theme
        return self.THEMES.get(theme_name, self.THEMES["xiaohongshu"])
    
    def get_theme_list(self) -> list:
        """è·å–æ‰€æœ‰ä¸»é¢˜åˆ—è¡¨"""
        return list(self.THEMES.keys())
    
    def get_theme_display_names(self) -> Dict[str, str]:
        """è·å–ä¸»é¢˜æ˜¾ç¤ºåç§°"""
        return {key: theme.name for key, theme in self.THEMES.items()}
    
    def set_theme(self, theme_name: str):
        """è®¾ç½®å½“å‰ä¸»é¢˜"""
        if theme_name in self.THEMES:
            self.current_theme = theme_name
    
    def hex_to_rgb(self, hex_color: str) -> Tuple[int, int, int]:
        """åå…­è¿›åˆ¶é¢œè‰²è½¬RGB"""
        hex_color = hex_color.lstrip('#')
        return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))
    
    def rgb_to_hex(self, r: int, g: int, b: int) -> str:
        """RGBè½¬åå…­è¿›åˆ¶"""
        return f"#{r:02x}{g:02x}{b:02x}"
    
    def lighten_color(self, hex_color: str, amount: float) -> str:
        """ä½¿é¢œè‰²å˜æµ…ï¼ˆamount: 0-1ï¼‰"""
        r, g, b = self.hex_to_rgb(hex_color)
        # è½¬æ¢ä¸ºHSL
        h, l, s = colorsys.rgb_to_hls(r/255, g/255, b/255)
        # å¢åŠ äº®åº¦
        l = min(1.0, l + (1 - l) * amount)
        # è½¬å›RGB
        r, g, b = colorsys.hls_to_rgb(h, l, s)
        return self.rgb_to_hex(int(r*255), int(g*255), int(b*255))
    
    def darken_color(self, hex_color: str, amount: float) -> str:
        """ä½¿é¢œè‰²å˜æ·±ï¼ˆamount: 0-1ï¼‰"""
        r, g, b = self.hex_to_rgb(hex_color)
        # è½¬æ¢ä¸ºHSL
        h, l, s = colorsys.rgb_to_hls(r/255, g/255, b/255)
        # é™ä½äº®åº¦
        l = max(0.0, l * (1 - amount))
        # è½¬å›RGB
        r, g, b = colorsys.hls_to_rgb(h, l, s)
        return self.rgb_to_hex(int(r*255), int(g*255), int(b*255))
    
    def add_alpha(self, hex_color: str, alpha: float) -> str:
        """æ·»åŠ é€æ˜åº¦ï¼ˆè¿”å›rgbaæ ¼å¼ï¼‰"""
        r, g, b = self.hex_to_rgb(hex_color)
        return f"rgba({r}, {g}, {b}, {alpha})"
    
    def generate_css(self, theme_name: str = None, font_size: int = 18) -> str:
        """ç”Ÿæˆä¸»é¢˜CSS"""
        theme = self.get_theme(theme_name)
        
        # ç”Ÿæˆæ´¾ç”Ÿé¢œè‰²
        primary_light = self.lighten_color(theme.primary_color, 0.9)
        primary_dark = self.darken_color(theme.primary_color, 0.2)
        secondary_light = self.lighten_color(theme.secondary_color, 0.9)
        
        # æ£€æŸ¥æ˜¯å¦ä¸ºæ·±è‰²ä¸»é¢˜
        is_dark = theme_name in ["dark_mode", "midnight", "douyin"]
        
        return f"""
        /* ä¸»é¢˜: {theme.name} */
        :root {{
            --primary-color: {theme.primary_color};
            --secondary-color: {theme.secondary_color};
            --accent-color: {theme.accent_color or theme.secondary_color};
            --text-color: {theme.text_color};
            --link-color: {theme.link_color or theme.primary_color};
            --font-family: {theme.font_family};
            --heading-font: {theme.heading_font};
            --code-font: {theme.code_font};
            --primary-light: {primary_light};
            --primary-dark: {primary_dark};
            --secondary-light: {secondary_light};
            --base-font-size: {font_size}px;
        }}
        
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        
        body {{
            font-family: var(--font-family);
            background: {theme.background};
            color: var(--text-color);
            font-size: var(--base-font-size);
            line-height: 1.85;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }}
        
        /* æ ‡é¢˜æ ·å¼ */
        h1, h2, h3, h4, h5, h6 {{
            font-family: var(--heading-font);
            color: var(--primary-color);
            font-weight: 700;
            letter-spacing: -0.02em;
        }}
        
        h1 {{
            font-size: calc(var(--base-font-size) + 16px);
            margin-bottom: 28px;
            padding-bottom: 16px;
            border-bottom: 3px solid {self.add_alpha(theme.primary_color, 0.2)};
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }}
        
        h2 {{
            font-size: calc(var(--base-font-size) + 10px);
            margin-top: 38px;
            margin-bottom: 22px;
            position: relative;
            padding-left: 20px;
        }}
        
        h2::before {{
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 24px;
            background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
            box-shadow: 0 2px 8px {self.add_alpha(theme.primary_color, 0.3)};
        }}
        
        h3 {{
            font-size: calc(var(--base-font-size) + 5px);
            margin-top: 30px;
            margin-bottom: 18px;
            color: {theme.text_color if not is_dark else theme.secondary_color};
        }}
        
        /* æ®µè½æ ·å¼ */
        p {{
            margin-bottom: 22px;
            font-size: var(--base-font-size);
            color: var(--text-color);
            text-align: justify;
            line-height: 1.85;
        }}
        
        /* å¼ºè°ƒæ ·å¼ */
        strong {{
            color: var(--primary-color);
            font-weight: 600;
            background: linear-gradient(180deg, transparent 70%, {self.add_alpha(theme.primary_color, 0.2)} 70%);
            padding: 0 4px;
            border-radius: 2px;
        }}
        
        em {{
            font-style: italic;
            color: {self.darken_color(theme.text_color, 0.2) if not is_dark else self.lighten_color(theme.text_color, 0.2)};
        }}
        
        /* åˆ—è¡¨æ ·å¼ */
        ul, ol {{
            margin: 24px 0;
            padding-left: 38px;
        }}
        
        li {{
            margin-bottom: 16px;
            font-size: var(--base-font-size);
            color: var(--text-color);
            line-height: 1.85;
            position: relative;
        }}
        
        ul li::marker {{
            color: var(--primary-color);
            font-size: calc(var(--base-font-size) + 2px);
        }}
        
        ol li::marker {{
            color: var(--primary-color);
            font-weight: 600;
        }}
        
        /* å¼•ç”¨æ ·å¼ */
        blockquote {{
            border-left: 4px solid var(--primary-color);
            margin: 28px 0;
            padding: 20px 28px;
            background: {self.add_alpha(theme.primary_color, 0.05) if not is_dark else self.add_alpha(theme.primary_color, 0.1)};
            border-radius: 10px;
            position: relative;
            box-shadow: 0 4px 15px {self.add_alpha(theme.primary_color, 0.1)};
        }}
        
        blockquote::before {{
            content: '"';
            position: absolute;
            top: -10px;
            left: 24px;
            font-size: 48px;
            color: {self.add_alpha(theme.primary_color, 0.3)};
            font-family: Georgia, serif;
            font-weight: bold;
        }}
        
        blockquote p {{
            color: {self.darken_color(theme.text_color, 0.1) if not is_dark else self.lighten_color(theme.text_color, 0.1)};
            font-style: italic;
            margin-bottom: 0;
            font-size: calc(var(--base-font-size) - 1px);
        }}
        
        /* è¡Œå†…ä»£ç  */
        code {{
            background: {self.add_alpha(theme.primary_color, 0.1)};
            padding: 4px 10px;
            border-radius: 6px;
            font-family: var(--code-font);
            font-size: calc(var(--base-font-size) - 2px);
            color: {theme.primary_color if not is_dark else theme.accent_color};
            font-weight: 500;
            border: 1px solid {self.add_alpha(theme.primary_color, 0.2)};
        }}
        
        /* ä»£ç å— */
        pre {{
            background: {('#1e1e1e' if not is_dark else '#0a0a0f')};
            color: #d4d4d4;
            padding: 26px;
            border-radius: 12px;
            overflow-x: auto;
            margin: 28px 0;
            box-shadow: 0 8px 24px {self.add_alpha('#000000', 0.15)};
            position: relative;
            border: 1px solid {self.add_alpha(theme.primary_color, 0.2)};
        }}
        
        pre::before {{
            content: "CODE";
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 11px;
            color: {self.add_alpha(theme.text_color, 0.5)};
            font-weight: 600;
            letter-spacing: 1px;
            font-family: var(--font-family);
        }}
        
        pre code {{
            background: none;
            color: #d4d4d4;
            padding: 0;
            font-size: calc(var(--base-font-size) - 3px);
            line-height: 1.7;
            border: none;
        }}
        
        /* è¡¨æ ¼æ ·å¼ */
        table {{
            width: 100%;
            border-collapse: collapse;
            margin: 28px 0;
            font-size: calc(var(--base-font-size) - 1px);
            box-shadow: 0 4px 15px {self.add_alpha(theme.primary_color, 0.08)};
            border-radius: 10px;
            overflow: hidden;
        }}
        
        th {{
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 20px;
            text-align: left;
            font-weight: 600;
            font-size: calc(var(--base-font-size) - 1px);
            letter-spacing: 0.5px;
        }}
        
        td {{
            padding: 15px 20px;
            border-bottom: 1px solid {self.add_alpha(theme.text_color, 0.1)};
            color: var(--text-color);
        }}
        
        tr:nth-child(even) {{
            background: {self.add_alpha(theme.primary_color, 0.03)};
        }}
        
        tr:hover {{
            background: {self.add_alpha(theme.primary_color, 0.08)};
            transition: background 0.3s ease;
        }}
        
        tr:last-child td {{
            border-bottom: none;
        }}
        
        /* åˆ†éš”çº¿ */
        hr {{
            border: none;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent, 
                {self.add_alpha(theme.primary_color, 0.3)} 20%, 
                {self.add_alpha(theme.primary_color, 0.3)} 80%, 
                transparent);
            margin: 38px 0;
            position: relative;
        }}
        
        hr::after {{
            content: "âœ¦";
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: {theme.background.split('(')[0] + '(180deg, #FFFFFF 0%, #FFFFFF 100%)' if 'gradient' in theme.background else '#FFFFFF'};
            color: var(--primary-color);
            padding: 0 10px;
            font-size: 20px;
        }}
        
        /* é“¾æ¥æ ·å¼ */
        a {{
            color: var(--link-color);
            text-decoration: none;
            border-bottom: 2px solid {self.add_alpha(theme.link_color or theme.primary_color, 0.3)};
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding-bottom: 1px;
            position: relative;
        }}
        
        a:hover {{
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
            background: {self.add_alpha(theme.primary_color, 0.08)};
            padding: 2px 6px;
            margin: -2px -6px;
            border-radius: 4px;
        }}
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {{
            from {{
                opacity: 0;
                transform: translateY(10px);
            }}
            to {{
                opacity: 1;
                transform: translateY(0);
            }}
        }}
        
        .content > * {{
            animation: fadeIn 0.5s ease-out backwards;
        }}
        
        .content > *:nth-child(1) {{ animation-delay: 0.05s; }}
        .content > *:nth-child(2) {{ animation-delay: 0.1s; }}
        .content > *:nth-child(3) {{ animation-delay: 0.15s; }}
        .content > *:nth-child(4) {{ animation-delay: 0.2s; }}
        .content > *:nth-child(5) {{ animation-delay: 0.25s; }}
        
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {{
            width: 8px;
            height: 8px;
        }}
        
        ::-webkit-scrollbar-track {{
            background: {self.add_alpha(theme.text_color, 0.05)};
            border-radius: 4px;
        }}
        
        ::-webkit-scrollbar-thumb {{
            background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
            border-radius: 4px;
        }}
        
        ::-webkit-scrollbar-thumb:hover {{
            background: linear-gradient(180deg, var(--secondary-color), var(--primary-color));
        }}
        """
    
    def get_export_settings(self, theme_name: str = None) -> Dict[str, Any]:
        """è·å–å¯¼å‡ºè®¾ç½®"""
        theme = self.get_theme(theme_name)
        
        return {
            "theme_name": theme.name,
            "page_width": 1080,
            "page_height": 1440,
            "padding": {
                "top": 45,
                "bottom": 45,
                "left": 40,
                "right": 40
            },
            "font_size": 16,
            "line_height": 1.8,
            "paragraph_spacing": 20,
            "image_quality": 100,
            "format": "PNG",
            "colors": {
                "primary": theme.primary_color,
                "secondary": theme.secondary_color,
                "text": theme.text_color,
                "background": theme.background
            }
        }
    
    def apply_custom_styles(self, styles: Dict[str, str]):
        """åº”ç”¨è‡ªå®šä¹‰æ ·å¼"""
        self.custom_styles.update(styles)
    
    def get_combined_css(self, theme_name: str = None, font_size: int = 18) -> str:
        """è·å–ç»„åˆçš„CSSï¼ˆä¸»é¢˜ + è‡ªå®šä¹‰ï¼‰"""
        base_css = self.generate_css(theme_name, font_size)
        
        if self.custom_styles:
            custom_css = "\n/* è‡ªå®šä¹‰æ ·å¼ */\n"
            for selector, rules in self.custom_styles.items():
                custom_css += f"{selector} {{\n{rules}\n}}\n"
            return base_css + custom_css
        
        return base_css
```
 ### 2. **html_generator.py** - æ›´æ–°ä»¥æ”¯æŒä¸»é¢˜ ä»£ç 
```python
# ============================================
# src/core/html_generator.py
# ============================================
from pathlib import Path
from typing import Optional
from src.utils.style_manager import StyleManager

class HTMLGenerator:
    def __init__(self, font_size: int = 18, page_size: str = "medium", theme: str = "xiaohongshu"):
        self.resource_path = Path(__file__).parent.parent / "resources"
        self.base_font_size = font_size  # åŸºç¡€å­—ä½“å¤§å°ï¼Œé»˜è®¤18px
        
        # é¡µé¢å°ºå¯¸é…ç½®
        self.page_sizes = {
            "small": {"width": 720, "height": 960},
            "medium": {"width": 1080, "height": 1440},
            "large": {"width": 1440, "height": 1920}
        }
        self.current_size = page_size
        self.page_width = self.page_sizes[page_size]["width"]
        self.page_height = self.page_sizes[page_size]["height"]
        
        # æ ·å¼ç®¡ç†å™¨
        self.style_manager = StyleManager(theme)
        self.current_theme = theme
        
    def set_page_size(self, size: str):
        """è®¾ç½®é¡µé¢å°ºå¯¸"""
        if size in self.page_sizes:
            self.current_size = size
            self.page_width = self.page_sizes[size]["width"]
            self.page_height = self.page_sizes[size]["height"]
    
    def set_theme(self, theme: str):
        """è®¾ç½®ä¸»é¢˜"""
        self.current_theme = theme
        self.style_manager.set_theme(theme)
    
    def set_font_size(self, size: int):
        """è®¾ç½®åŸºç¡€å­—ä½“å¤§å°"""
        self.base_font_size = size
        
    def generate(self, content: str, page_num: int = 0, total_pages: int = 0) -> str:
        """
        ç”Ÿæˆå®Œæ•´çš„ HTML é¡µé¢
        
        Args:
            content: HTMLå†…å®¹
            page_num: å½“å‰é¡µç ï¼ˆ0è¡¨ç¤ºä¸æ˜¾ç¤ºï¼‰
            total_pages: æ€»é¡µæ•°
        """
        # ç”Ÿæˆä¸»é¢˜CSS
        theme_css = self.style_manager.generate_css(self.current_theme, self.base_font_size)
        
        # ç”Ÿæˆé¡µé¢ç‰¹å®šCSS
        page_css = self.get_page_css()
        
        # è·å–JavaScript
        js = self.get_js()
        
        # ç”Ÿæˆé¡µç ä¿¡æ¯ï¼ˆå¦‚æœéœ€è¦ï¼‰
        page_info = ""
        if page_num > 0 and total_pages > 1:
            page_info = f"""
            <div class="page-info">
                <span class="page-number">{page_num}</span>
                <span class="page-separator">/</span>
                <span class="page-total">{total_pages}</span>
            </div>
            """
        
        html = f"""
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°çº¢ä¹¦å¡ç‰‡ - {self.style_manager.get_theme().name}</title>
    <style>
        {theme_css}
        {page_css}
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="content" id="content">
                {content}
            </div>
            {page_info}
        </div>
    </div>
    <script>{js}</script>
</body>
</html>
"""
        return html
    
    def get_page_css(self) -> str:
        """è·å–é¡µé¢å¸ƒå±€CSS"""
        theme = self.style_manager.get_theme()
        
        # æ£€æŸ¥æ˜¯å¦ä¸ºæ·±è‰²ä¸»é¢˜
        is_dark = self.current_theme in ["dark_mode", "midnight", "douyin"]
        
        return f"""
        /* é¡µé¢å¸ƒå±€ */
        html, body {{
            width: {self.page_width}px;
            height: {self.page_height}px;
            overflow: hidden !important;
            margin: 0;
            padding: 0;
        }}
        
        .container {{
            width: {self.page_width}px;
            height: {self.page_height}px;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
        }}
        
        .card {{
            width: 100%;
            height: 100%;
            background: {'rgba(255, 255, 255, 0.98)' if not is_dark else 'rgba(20, 20, 35, 0.98)'};
            border-radius: 20px;
            box-shadow: 0 20px 60px {self.style_manager.add_alpha(theme.primary_color, 0.15)},
                        0 10px 30px {self.style_manager.add_alpha('#000000', 0.1)};
            overflow: hidden;
            position: relative;
        }}
        
        .content {{
            padding: 50px 45px 70px 45px;
            color: var(--text-color);
            line-height: 1.85;
            height: 100%;
            overflow: hidden !important;
            position: relative;
        }}
        
        /* é¡µç ä¿¡æ¯ */
        .page-info {{
            position: absolute;
            bottom: 20px;
            right: 30px;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 16px;
            background: {self.style_manager.add_alpha(theme.primary_color, 0.1)};
            border-radius: 20px;
            border: 1px solid {self.style_manager.add_alpha(theme.primary_color, 0.2)};
        }}
        
        .page-number {{
            font-weight: 700;
            color: var(--primary-color);
            font-size: 14px;
        }}
        
        .page-separator {{
            color: {self.style_manager.add_alpha(theme.text_color, 0.4)};
            font-size: 12px;
        }}
        
        .page-total {{
            color: {self.style_manager.add_alpha(theme.text_color, 0.6)};
            font-size: 14px;
        }}
        
        /* è£…é¥°å…ƒç´  */
        .card::before {{
            content: "";
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, {self.style_manager.add_alpha(theme.primary_color, 0.1)} 0%, transparent 70%);
            pointer-events: none;
        }}
        
        .card::after {{
            content: "";
            position: absolute;
            bottom: -50%;
            left: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, {self.style_manager.add_alpha(theme.secondary_color, 0.1)} 0%, transparent 70%);
            pointer-events: none;
        }}
        
        /* å“åº”å¼å›¾ç‰‡ */
        img {{
            max-width: 100%;
            height: auto;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 8px 24px {self.style_manager.add_alpha('#000000', 0.1)};
        }}
        
        /* éšè—æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {{
            display: none !important;
        }}
        
        * {{
            scrollbar-width: none !important;
            -ms-overflow-style: none !important;
        }}
        
        /* æ‰“å°æ ·å¼ */
        @media print {{
            body {{
                background: white;
                padding: 0;
            }}
            
            .container {{
                max-width: 100%;
            }}
            
            .card {{
                box-shadow: none;
                border-radius: 0;
                page-break-inside: avoid;
            }}
            
            .card::before,
            .card::after {{
                display: none;
            }}
        }}
        """
    
    def get_js(self) -> str:
        """è·å–JavaScriptä»£ç """
        return """
        // é¡µé¢åŠ è½½å®Œæˆåçš„å¤„ç†
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ æ·¡å…¥åŠ¨ç”»
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '0';
                content.style.transition = 'opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                setTimeout(() => {
                    content.style.opacity = '1';
                }, 100);
            }
            
            // å›¾ç‰‡å»¶è¿ŸåŠ è½½å’ŒåŠ¨ç”»
            const images = document.querySelectorAll('img');
            images.forEach((img, index) => {
                img.loading = 'lazy';
                img.style.opacity = '0';
                img.style.transform = 'translateY(20px)';
                img.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                
                // å›¾ç‰‡åŠ è½½å®Œæˆåæ˜¾ç¤º
                if (img.complete) {
                    setTimeout(() => {
                        img.style.opacity = '1';
                        img.style.transform = 'translateY(0)';
                    }, 100 * (index + 1));
                } else {
                    img.addEventListener('load', () => {
                        setTimeout(() => {
                            img.style.opacity = '1';
                            img.style.transform = 'translateY(0)';
                        }, 100);
                    });
                }
            });
            
            // ä»£ç å—å¢å¼º
            const codeBlocks = document.querySelectorAll('pre');
            codeBlocks.forEach(block => {
                // æ·»åŠ è¯­è¨€æ ‡è¯†
                const code = block.querySelector('code');
                if (code && code.className) {
                    const lang = code.className.replace('language-', '');
                    if (lang) {
                        block.setAttribute('data-language', lang.toUpperCase());
                    }
                }
            });
            
            // è¡¨æ ¼å¢å¼º
            const tables = document.querySelectorAll('table');
            tables.forEach(table => {
                // æ·»åŠ å“åº”å¼åŒ…è£…
                const wrapper = document.createElement('div');
                wrapper.style.overflowX = 'auto';
                wrapper.style.marginBottom = '20px';
                table.parentNode.insertBefore(wrapper, table);
                wrapper.appendChild(table);
            });
            
            // ç¡®ä¿å†…å®¹ä¸è¶…å‡º
            function ensureContentFit() {
                const card = document.querySelector('.card');
                const content = document.querySelector('.content');
                if (card && content) {
                    content.style.maxHeight = '100%';
                    content.style.overflow = 'hidden';
                }
            }
            
            ensureContentFit();
            window.addEventListener('resize', ensureContentFit);
        });
        
        // ç¦ç”¨æ‰€æœ‰æ»šåŠ¨
        window.addEventListener('scroll', function(e) {
            e.preventDefault();
            window.scrollTo(0, 0);
        }, { passive: false });
        
        window.addEventListener('wheel', function(e) {
            e.preventDefault();
        }, { passive: false });
        
        window.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
        """
```
 ### 3. **main_window.py** - æ·»åŠ ä¸»é¢˜é€‰æ‹©å™¨

ç”±äº main_window.py æ”¹åŠ¨è¾ƒå¤§ï¼Œæˆ‘æä¾›å…³é”®ä¿®æ”¹ä½ç½®ï¼š

**åœ¨å·¥å…·æ éƒ¨åˆ†æ·»åŠ ï¼ˆçº¦ç¬¬45è¡Œåï¼‰**ï¼š

```python
# åœ¨åˆ›å»ºå·¥å…·æ æŒ‰é’®åæ·»åŠ ä¸»é¢˜é€‰æ‹©å™¨
from PySide6.QtWidgets import QComboBox

# ... existing toolbar code ...

# æ·»åŠ åˆ†éš”å™¨
toolbar.addSeparator()

# ä¸»é¢˜é€‰æ‹©å™¨
theme_label = QLabel("ä¸»é¢˜:")
theme_label.setStyleSheet("""
    QLabel {
        color: #00e0ff;
        font-size: 14px;
        padding: 0 10px;
    }
""")
toolbar.addWidget(theme_label)

self.theme_selector = QComboBox()
self.theme_selector.setFixedWidth(150)

# ä»style_managerè·å–ä¸»é¢˜åˆ—è¡¨
from src.utils.style_manager import StyleManager
style_manager = StyleManager()
themes = style_manager.get_theme_display_names()

for key, name in themes.items():
    self.theme_selector.addItem(name, key)

self.theme_selector.setCurrentText("å°çº¢ä¹¦ç»å…¸")
self.theme_selector.setStyleSheet("""
    QComboBox {
        background: qlineargradient(
            x1: 0, y1: 0, x2: 0, y2: 1,
            stop: 0 rgba(0, 224, 255, 0.15),
            stop: 1 rgba(0, 150, 255, 0.1)
        );
        border: 1px solid rgba(0, 224, 255, 0.4);
        border-radius: 8px;
        padding: 8px 12px;
        color: #00e0ff;
        font-weight: 500;
        font-size: 13px;
    }
    QComboBox:hover {
        background: qlineargradient(
            x1: 0, y1: 0, x2: 0, y2: 1,
            stop: 0 rgba(0, 224, 255, 0.25),
            stop: 1 rgba(0, 150, 255, 0.2)
        );
        border: 1px solid rgba(0, 224, 255, 0.6);
    }
    QComboBox::drop-down {
        border: none;
        width: 25px;
    }
    QComboBox::down-arrow {
        image: none;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-top: 6px solid #00e0ff;
        margin-right: 8px;
    }
    QComboBox QAbstractItemView {
        background: rgba(25, 25, 40, 0.98);
        border: 1px solid rgba(0, 224, 255, 0.4);
        color: #00e0ff;
        selection-background-color: rgba(0, 224, 255, 0.3);
        outline: none;
        padding: 5px;
    }
    QComboBox QAbstractItemView::item {
        min-height: 30px;
        padding: 5px;
    }
    QComboBox QAbstractItemView::item:hover {
        background: rgba(0, 224, 255, 0.2);
    }
""")

toolbar.addWidget(self.theme_selector)

# è¿æ¥ä¸»é¢˜é€‰æ‹©ä¿¡å·
self.theme_selector.currentIndexChanged.connect(self.on_theme_changed)
```

**åœ¨ setup_connections æ–¹æ³•åæ·»åŠ **ï¼š

```python
def on_theme_changed(self, index):
    """å¤„ç†ä¸»é¢˜æ”¹å˜"""
    theme_key = self.theme_selector.currentData()
    if theme_key:
        # é€šçŸ¥é¢„è§ˆç»„ä»¶æ›´æ–°ä¸»é¢˜
        self.preview.change_theme(theme_key)
        
        # æ›´æ–°çŠ¶æ€æ 
        theme_name = self.theme_selector.currentText()
        self.status_bar.showMessage(f"å·²åˆ‡æ¢åˆ°ä¸»é¢˜: {theme_name}", 3000)
```

### 4. **preview_widget.py** - æ·»åŠ ä¸»é¢˜åˆ‡æ¢æ–¹æ³•

åœ¨ PreviewWidget ç±»ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼ˆçº¦ç¬¬450è¡Œåï¼‰ï¼š

```python
def change_theme(self, theme: str):
    """åˆ‡æ¢ä¸»é¢˜"""
    # æ›´æ–°HTMLç”Ÿæˆå™¨çš„ä¸»é¢˜
    self.html_generator.set_theme(theme)
    
    # å¦‚æœæœ‰å†…å®¹ï¼Œé‡æ–°æ¸²æŸ“å½“å‰é¡µ
    if self.current_pages:
        self.display_current_page()
        
    # è§¦å‘ä¸»é¢˜æ”¹å˜ä¿¡å·ï¼ˆå¦‚æœéœ€è¦ï¼‰
    # self.themeChanged.emit(theme)
```

## å®Œæ•´çš„ä½¿ç”¨æµç¨‹

1. **å¯åŠ¨åº”ç”¨**
   - é»˜è®¤æ˜¾ç¤º"å°çº¢ä¹¦ç»å…¸"ä¸»é¢˜
   - ä¸­ç­‰å°ºå¯¸ï¼ˆ1080Ã—1440ï¼‰

2. **é€‰æ‹©å°ºå¯¸**
   - åœ¨é¢„è§ˆåŒºé¡¶éƒ¨é€‰æ‹©ï¼šå°/ä¸­/å¤§
   - å†…å®¹ä¼šè‡ªåŠ¨é‡æ–°åˆ†é¡µ

3. **é€‰æ‹©ä¸»é¢˜**
   - åœ¨å·¥å…·æ é€‰æ‹©12ç§ä¸»é¢˜ä¹‹ä¸€
   - å®æ—¶é¢„è§ˆæ•ˆæœ

4. **å¯¼å‡ºå›¾ç‰‡**
   - ç‚¹å‡»"å¯¼å‡ºå›¾ç‰‡"
   - ä¿æŒå½“å‰å°ºå¯¸å’Œä¸»é¢˜å¯¼å‡º

## ä¸»é¢˜ç‰¹è‰²è¯´æ˜

### ç¤¾äº¤åª’ä½“é£æ ¼
- **å°çº¢ä¹¦ç»å…¸**ï¼šç²‰è‰²ç³»ï¼Œæ¸©æš–äº²åˆ‡
- **Instagramæ¸å˜**ï¼šå½©è™¹æ¸å˜ï¼Œæ´»åŠ›åè¶³
- **å¾®ä¿¡ç®€çº¦**ï¼šç»¿è‰²ç³»ï¼Œæ¸…æ–°ç®€æ´
- **æŠ–éŸ³é…·é»‘**ï¼šé»‘è‰²èƒŒæ™¯ï¼Œéœ“è™¹è‰²å½©

### çŸ¥è¯†å¹³å°é£æ ¼
- **çŸ¥ä¹è“**ï¼šä¸“ä¸šå¯ä¿¡ï¼ŒçŸ¥è¯†åˆ†äº«
- **Notionæç®€**ï¼šé»‘ç™½æç®€ï¼Œä¸“æ³¨å†…å®¹

### ä¼˜é›…é£æ ¼
- **ä¼˜é›…ç´«**ï¼šé«˜è´µå…¸é›…ï¼Œè‰ºæœ¯æ°”æ¯
- **æµ·æ´‹è“**ï¼šæ¸…çˆ½èˆ’é€‚ï¼Œä¸“ä¸šæ„Ÿ
- **æ—¥è½æ©™**ï¼šæ¸©æš–æ´»åŠ›ï¼Œåˆ›æ„åè¶³
- **æ£®æ—ç»¿**ï¼šè‡ªç„¶æ¸…æ–°ï¼ŒæŠ¤çœ¼èˆ’é€‚

### æ·±è‰²ä¸»é¢˜
- **æ·±è‰²æ¨¡å¼**ï¼šç§‘æŠ€æ„Ÿï¼ŒæŠ¤çœ¼
- **åˆå¤œç´«**ï¼šç¥ç§˜ä¼˜é›…ï¼Œå¤œé—´é˜…è¯»

## æµ‹è¯•å»ºè®®

1. åˆ‡æ¢ä¸åŒä¸»é¢˜ï¼Œæ£€æŸ¥é¢œè‰²æ­é…
2. æµ‹è¯•ä¸åŒå°ºå¯¸ä¸‹çš„åˆ†é¡µæ•ˆæœ
3. éªŒè¯å¯¼å‡ºå›¾ç‰‡çš„ä¸»é¢˜æ˜¯å¦æ­£ç¡®
4. æ£€æŸ¥æ·±è‰²ä¸»é¢˜çš„å¯è¯»æ€§

éœ€è¦æˆ‘ç»§ç»­ç¬¬ä¸‰æ­¥ï¼ˆä¼˜åŒ–UIäº¤äº’ï¼‰å—ï¼Ÿ
